<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>笔记</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="笔记"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="笔记"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="笔记"><meta property="og:type" content="blog"><meta property="og:title" content="笔记"><meta property="og:url" content="https://www.chengyao.xyz/"><meta property="og:site_name" content="笔记"><meta property="og:description" content="笔记"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.chengyao.xyz/img/og_image.png"><meta property="article:author" content="CY"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://www.chengyao.xyz/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.chengyao.xyz"},"headline":"笔记","image":["https://www.chengyao.xyz/img/og_image.png"],"author":{"@type":"Person","name":"CY"},"publisher":{"@type":"Organization","name":"笔记","logo":{"@type":"ImageObject","url":"https://www.chengyao.xyz/images/avatar.jpg"}},"description":"笔记"}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(location.hash);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/avatar.jpg" alt="笔记" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/tab-engineer"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-04-06T15:37:38.000Z" title="2022/4/6 下午11:37:38">2022-04-06</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.673Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">8 分钟读完 (大约1226个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/04/06/Docker%E9%83%A8%E7%BD%B2LNMP%E8%BF%90%E8%A1%8CMaxPHP/">Docker部署LNMP运行MaxPHP</a></h1><div class="content"><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><ul>
<li>linux[腾讯云ubuntu20.04]</li>
</ul>
<p><strong>也可以手动安装docker</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install docker.io</span><br></pre></td></tr></table></figure>

<h2 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h2><p>lnmp指的是linux，nginx，mysql，php。 MaxPHP是运行在php的cli模式下的框架，所以不需要安装fpm。下面介绍docker安装lnmp的一些步骤，来运行MaxPHP类似的框架，这里软件均选择最新版本</p>
<blockquote>
<p>为了多个容器可以通信，需要新建一个网桥</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network create -d bridge lnmp</span><br></pre></td></tr></table></figure>

<h3 id="安装nginx"><a href="#安装nginx" class="headerlink" title="安装nginx"></a>安装nginx</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull nginx</span><br></pre></td></tr></table></figure>

<p>拉取镜像后使用下面的命令运行容器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name nginx -v /www:/www -p 80:80 -p 443:443 --network lnmp &lt;镜像id&gt;</span><br></pre></td></tr></table></figure>

<p>这里我做了http和https默认两个端口的映射，下面是我的网站配置文件，具体需要代理的主机需要使用下面的命令查看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network inspect lnmp</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">server</span><br><span class="line">&#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    listen 443 ssl http2;</span><br><span class="line">    server_name 1kmb.com www.1kmb.com;</span><br><span class="line">    index index.php index.html index.htm default.php default.htm default.html;</span><br><span class="line">    root /www/wwwroot/1kmb.com.main/public;</span><br><span class="line">    location / &#123;</span><br><span class="line">      proxy_set_header Host $host;</span><br><span class="line">      proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">      if (!-f $request_filename ) &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:9999;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    #SSL-START SSL相关配置，请勿删除或修改下一行带注释的404规则</span><br><span class="line">    #error_page 404/404.html;</span><br><span class="line">    #limit_conn perserver 50;</span><br><span class="line">    #limit_conn perip 15;</span><br><span class="line">    #limit_rate 256k;</span><br><span class="line">    #HTTP_TO_HTTPS_START</span><br><span class="line">    </span><br><span class="line">    if ($host !~ &quot;www&quot;) &#123;</span><br><span class="line">      rewrite ^(/.*)$ https://www.$host$1 permanent;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if ($server_port !~ 443)&#123;</span><br><span class="line">        rewrite ^(/.*)$ https://$host$1 permanent;</span><br><span class="line">    &#125;</span><br><span class="line">    #HTTP_TO_HTTPS_END</span><br><span class="line">    ssl_certificate    /www/server/panel/vhost/cert/1kmb.com.main/fullchain.pem;</span><br><span class="line">    ssl_certificate_key    /www/server/panel/vhost/cert/1kmb.com.main/privkey.pem;</span><br><span class="line">    ssl_protocols TLSv1.1 TLSv1.2 TLSv1.3;</span><br><span class="line">    ssl_ciphers EECDH+CHACHA20:EECDH+CHACHA20-draft:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line">    ssl_session_cache shared:SSL:10m;</span><br><span class="line">    ssl_session_timeout 10m;</span><br><span class="line">    add_header Strict-Transport-Security &quot;max-age=31536000&quot;;</span><br><span class="line">    error_page 497  https://$host$request_uri;</span><br><span class="line"></span><br><span class="line">    #SSL-END</span><br><span class="line">    </span><br><span class="line">    #ERROR-PAGE-START  错误页配置，可以注释、删除或修改</span><br><span class="line">    #error_page 404 /404.html;</span><br><span class="line">    #error_page 502 /502.html;</span><br><span class="line">    #ERROR-PAGE-END</span><br><span class="line">    </span><br><span class="line">    #PHP-INFO-START  PHP引用配置，可以注释或修改</span><br><span class="line">    # include enable-php-00.conf;</span><br><span class="line">    #PHP-INFO-END</span><br><span class="line">    </span><br><span class="line">    #REWRITE-START URL重写规则引用,修改后将导致面板设置的伪静态规则失效</span><br><span class="line">    # include /www/server/panel/vhost/rewrite/1kmb.com.main.conf;</span><br><span class="line">    #REWRITE-END</span><br><span class="line">    </span><br><span class="line">    #禁止访问的文件或目录</span><br><span class="line">    location ~ ^/(\.user.ini|\.htaccess|\.git|\.svn|\.project|LICENSE|README.md)</span><br><span class="line">    &#123;</span><br><span class="line">        return 404;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    #一键申请SSL证书验证目录相关设置</span><br><span class="line">    location ~ \.well-known&#123;</span><br><span class="line">        allow all;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$</span><br><span class="line">    &#123;</span><br><span class="line">        expires      30d;</span><br><span class="line">        error_log /dev/null;</span><br><span class="line">        access_log /dev/null;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    location ~ .*\.(js|css)?$</span><br><span class="line">    &#123;</span><br><span class="line">        expires      12h;</span><br><span class="line">        error_log /dev/null;</span><br><span class="line">        access_log /dev/null; </span><br><span class="line">    &#125;</span><br><span class="line">    access_log  /www/wwwlogs/1kmb.com.main.log;</span><br><span class="line">    error_log  /www/wwwlogs/1kmb.com.main.error.log;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">  listen 443 ssl;</span><br><span class="line">  server_name ws.1kmb.com;</span><br><span class="line">  location / &#123;</span><br><span class="line">    proxy_pass http://127.0.0.1:8787;</span><br><span class="line">    proxy_set_header Host $host;</span><br><span class="line">    proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">    proxy_http_version 1.1;</span><br><span class="line">    proxy_set_header   Sec-Websocket-Version 13;</span><br><span class="line">    proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">    proxy_set_header Connection $connection_upgrade;</span><br><span class="line">  &#125;</span><br><span class="line">    ssl_certificate    /www/wwwroot/7328958_ws.1kmb.com.pem;</span><br><span class="line">    ssl_certificate_key    /www/wwwroot/7328958_ws.1kmb.com.key;</span><br><span class="line">    ssl_protocols TLSv1.1 TLSv1.2 TLSv1.3;</span><br><span class="line">    ssl_ciphers EECDH+CHACHA20:EECDH+CHACHA20-draft:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line">    ssl_session_cache shared:SSL:10m;</span><br><span class="line">    ssl_session_timeout 10m;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我开启了websocket服务，所以配置了$connection_upgrade变量，配置方法如下</p>
<h2 id="配置-“-connection-upgrade”-变量"><a href="#配置-“-connection-upgrade”-变量" class="headerlink" title="配置 “$connection_upgrade” 变量"></a>配置 “$connection_upgrade” 变量</h2><p>连接升级通常与 WebSockets 结合使用。 在 nginx 中，我们可以根据 <code>$http_upgrade</code> 变量将 HTTP 连接升级为 WebSocket 连接。</p>
<p>我们可以使用 <strong>map</strong> 块在 nginx 中定义连接和 http 升级之间的依赖关系：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">map</span> <span class="variable">$http_upgrade</span> <span class="variable">$connection_upgrade</span> &#123;  </span><br><span class="line">    <span class="attribute">default</span> upgrade;</span><br><span class="line">    &#x27;&#x27;      close;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果 Upgrade 标头设置为 ‘’，此 <strong>map</strong> 块告诉 nginx 正确设置相关的 Connection 标头来关闭连接。</p>
<p>将 map 块放入 nginx 配置的 http 块中。 nginx 配置的默认文件路径是 <strong>&#x2F;etc&#x2F;nginx&#x2F;nginx.conf</strong> 。</p>
<p>这是一个使用定义 $connection_upgrade 变量的 map 块的 nginx 配置示例。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">user www-data;  </span><br><span class="line">worker_processes auto;  </span><br><span class="line">pid /run/nginx.pid;</span><br><span class="line"></span><br><span class="line">events &#123;  </span><br><span class="line">        multi_accept       on;</span><br><span class="line">        worker_connections 65535;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http &#123;  </span><br><span class="line">	sendfile on;</span><br><span class="line">	tcp_nopush on;</span><br><span class="line">	tcp_nodelay on;</span><br><span class="line">	…</span><br><span class="line"></span><br><span class="line">	# Connection header for WebSocket reverse proxy</span><br><span class="line">	map $http_upgrade $connection_upgrade &#123;</span><br><span class="line">	    default upgrade;</span><br><span class="line">	    &#x27;&#x27;      close;</span><br><span class="line">	&#125;</span><br><span class="line">	# further configurations …</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>保存更新的 nginx 配置文件。 然后，使用 nginx -t 再次检查配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo nginx -t</span><br><span class="line"></span><br><span class="line">nginx: the configuration file /etc/nginx/nginx.conf syntax is ok  </span><br><span class="line">nginx: configuration file /etc/nginx/nginx.conf <span class="built_in">test</span> is successful  </span><br></pre></td></tr></table></figure>

<p>如果配置文件出错导致容器不能启动，则可以使用下面命令拷贝配置文件到容器外部修改后再拷贝进去</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp /nginx.conf &lt;容器id&gt;:/etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure>

<h3 id="安装php"><a href="#安装php" class="headerlink" title="安装php"></a>安装php</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull php</span><br></pre></td></tr></table></figure>

<p>运行容器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name php81 --network lnmp -v /www:/www &lt;容器id&gt;</span><br></pre></td></tr></table></figure>

<p>添加pcntl（maxphp的切面实现使用了子进程扫描），redis，pdo，pdo_mysql扩展，从官网下载对应版本的源码包，解压后进入ext目录的对应扩展目录，执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">phpize</span><br><span class="line">./configure --enable-pcntl --with-php-config=/usr/local/php-config </span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>

<p>然后将扩展添加到配置文件中，配置文件可以通过php –ini查看</p>
<p>如果出现下面的报错</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error: openssl/ssl.h: No such file or directory</span><br></pre></td></tr></table></figure>

<p>就执行下下面的命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install openssl</span><br><span class="line">sudo apt-get install libssl-dev build-essential zlibc zlib-bin libidn11-dev libidn11</span><br></pre></td></tr></table></figure>


<h2 id="安装mysql"><a href="#安装mysql" class="headerlink" title="安装mysql"></a>安装mysql</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=root &lt;容器id&gt;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-03-13T09:30:53.000Z" title="2022/3/13 下午5:30:53">2022-03-13</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.673Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">1 分钟读完 (大约211个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/13/%E5%9B%9E%E8%BD%A6%E5%92%8C%E6%8D%A2%E8%A1%8C/">回车和换行</a></h1><div class="content"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;\r&#x27;是回车，前者使光标到行首，（carriage return）</span><br><span class="line">&#x27;\n&#x27;是换行，后者使光标下移一格，（line feed）</span><br></pre></td></tr></table></figure>

<p>对于换行这个动作，unix下一般只有一个0x0A表示换行(“\n”），windows下一般都是0x0D和0x0A两个字符(“\r\n”)，苹果机(MAC OS系统)则采用回车符CR表示下一行(\r)Unix系统里，每行结尾只有“&lt;换行&gt;”，即“\n”；Windows系统里面，每行结尾是“&lt;回车&gt;&lt;换行&gt;”，即“\r\n”；Mac系统里，每行结尾是“&lt;回车&gt;”,即“\r”。</p>
<p>windows采用回车+换行CR&#x2F;LF表示下一行,即^M$（$不是换行符的表示，换行符没有表示出来，$是文本结束EOF的表示）</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-03-12T10:41:49.000Z" title="2022/3/12 下午6:41:49">2022-03-12</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.673Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">12 分钟读完 (大约1786个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/12/htop%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/">htop使用详解</a></h1><div class="content"><p><strong>一．Htop的使用简介</strong></p>
<p>大家可能对top监控软件比较熟悉，今天我为大家介绍另外一个监控软件Htop，姑且称之为top的增强版，相比top其有着很多自身的优势。如下：</p>
<ul>
<li>两者相比起来，top比较繁琐</li>
<li>默认支持图形界面的鼠标操作</li>
<li>可以横向或纵向滚动浏览进程列表，以便看到所有的进程和完整的命令行</li>
<li>杀进程时不需要输入进程号等</li>
</ul>
<p><strong>二．软件的获取与安装</strong></p>
<p>Htop的安装，既可以通过源码包编译安装，也可以配置好yum源后网络下载安装</p>
<p><strong>2.1源码安装</strong></p>
<p>  在htop的项目官方网站上：<a target="_blank" rel="noopener" href="http://sourceforge.net/projects/htop/%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BD%E5%8D%B3%E5%8F%AF">http://sourceforge.net/projects/htop/直接下载即可</a></p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210952_604.png" alt="Linux htop工具使用详解"></p>
<p>由于我已经安装过了，因此大家看个以上每个编译过程后面都会^c，是不执行此行操作Ctrl+c取消的，此处只是告知如何编译安装的，各人的环境不同，可能编译过程中会出现错误，根据错误，解决后即可。</p>
<p><strong>2.2 yum和rpm包安装</strong></p>
<p>个人推荐yum安装，能够自动的解决软件包依赖关系，安装即可。</p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210952_198.png" alt="Linux htop工具使用详解"></p>
<p><strong>三．Htop的使用</strong></p>
<p>安装完成后，命令行中直接敲击htop命令，即可进入htop的界面</p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210952_64.png" alt="Linux htop工具使用详解"></p>
<p>各项从上至下分别说明如下：</p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210953_803.png" alt="Linux htop工具使用详解"></p>
<p>左边部分从上至下，分别为，cpu、内存、交换分区的使用情况，右边部分为：Tasks为进程总数，当前运行的进程数、Load average为系统1分钟，5分钟，10分钟的平均负载情况、Uptime为系统运行的时间。</p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210953_984.png" alt="Linux htop工具使用详解"></p>
<p>以上各项分别为：</p>
<ul>
<li>PID：进行的标识号</li>
<li>USER：运行此进程的用户</li>
<li>PRI：进程的优先级</li>
<li>NI：进程的优先级别值，默认的为0，可以进行调整</li>
<li>VIRT：进程占用的虚拟内存值</li>
<li>RES：进程占用的物理内存值</li>
<li>SHR：进程占用的共享内存值</li>
<li>S：进程的运行状况，R表示正在运行、S表示休眠，等待唤醒、Z表示僵死状态</li>
<li>%CPU：该进程占用的CPU使用率</li>
<li>%MEM：该进程占用的物理内存和总内存的百分比</li>
<li>TIME+：该进程启动后占用的总的CPU时间</li>
<li>COMMAND：进程启动的启动命令名称</li>
</ul>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210953_292.png" alt="Linux htop工具使用详解"></p>
<p><strong>F1：显示帮助信息</strong></p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210954_995.png" alt="Linux htop工具使用详解"></p>
<table>
<thead>
<tr>
<th>h, ?</th>
<th>F1</th>
<th>查看htop使用说明</th>
</tr>
</thead>
<tbody><tr>
<td>S</td>
<td>F2</td>
<td>htop 设定</td>
</tr>
<tr>
<td>&#x2F;</td>
<td>F3</td>
<td>搜索进程</td>
</tr>
<tr>
<td>\</td>
<td>F4</td>
<td>增量进程过滤器</td>
</tr>
<tr>
<td>t</td>
<td>F5</td>
<td>显示树形结构</td>
</tr>
<tr>
<td>&lt;, &gt;</td>
<td>F6</td>
<td>选择排序方式</td>
</tr>
<tr>
<td>[</td>
<td>F7</td>
<td>可减少nice值可以提高对应进程的优先级</td>
</tr>
<tr>
<td>]</td>
<td>F8</td>
<td>可增加nice值，降低对应进程的优先级</td>
</tr>
<tr>
<td>k</td>
<td>F9</td>
<td>可对进程传递信号</td>
</tr>
<tr>
<td>q</td>
<td>F10</td>
<td>结束htop</td>
</tr>
<tr>
<td>u</td>
<td>只显示一个给定的用户的过程</td>
<td></td>
</tr>
<tr>
<td>U</td>
<td>取消标记所有的进程</td>
<td></td>
</tr>
<tr>
<td>H</td>
<td>显示或隐藏用户线程</td>
<td></td>
</tr>
<tr>
<td>K</td>
<td>显示或隐藏内核线程</td>
<td></td>
</tr>
<tr>
<td>F</td>
<td>跟踪进程</td>
<td></td>
</tr>
<tr>
<td>P</td>
<td>按CPU 使用排序</td>
<td></td>
</tr>
<tr>
<td>M</td>
<td>按内存使用排序</td>
<td></td>
</tr>
<tr>
<td>T</td>
<td>按Time+ 使用排序</td>
<td></td>
</tr>
<tr>
<td>l</td>
<td>显示进程打开的文件</td>
<td></td>
</tr>
<tr>
<td>I</td>
<td>倒转排序顺序</td>
<td></td>
</tr>
<tr>
<td>s</td>
<td>选择某进程，按s:用strace追踪进程的系统调用</td>
<td></td>
</tr>
</tbody></table>
<p><strong>F2 Htop设定</strong></p>
<p>鼠标点击Setup或者按下F2 之后进入htop 设定的页面，</p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210954_435.png" alt="Linux htop工具使用详解"></p>
<p>Setup 选项下的：</p>
<p><strong>1.Meters</strong></p>
<p>设定顶端的 显示信息，分为左右两侧，Left column 表示左侧的显示的信息，Right column表示右侧显示的信息，如果要新加选项，可以选择Available meters添加，F5新增到上方左侧，F6新增到上方右侧。Left column和Right column下面的选项，可以选定信息的显示方式，有LED、Bar(进度条)、Text(文本模式)，可以根据个人喜好进行设置</p>
<p><strong>2. Display options</strong></p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210955_617.png" alt="Linux htop工具使用详解"></p>
<p>选择要显示的内容，按空格 x表示显示，选择完后，按F10保存</p>
<p><strong>3.Colors</strong></p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210955_510.png" alt="Linux htop工具使用详解"></p>
<p>设定界面以什么颜色来显示，个人认为用处不大，各人喜好不同，假如我们选择Black on White后显示效果如下</p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210955_77.png" alt="Linux htop工具使用详解"></p>
<p><strong>4.Colums</strong></p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210955_60.png" alt="Linux htop工具使用详解"></p>
<p>作用是增加或取消要显示的各项内容，选择后F7(向上移动)、F8(向下移动)、F9(取消显示、F10(保存更改))此处增加了PPID、PGRP，根据各人需求，显示那些信息。</p>
<p><strong>F3 搜索进程</strong></p>
<p>在界面下按F3或直接输入”&#x2F;”就可以直接进入搜索模式，是按照进程名进行搜索的。例如</p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210956_380.png" alt="Linux htop工具使用详解"></p>
<p>搜索到的进程会用设定的颜色标记出来，方便查看</p>
<p><strong>F4：过滤器</strong></p>
<p>相当于模糊查找，不区分大小写，下方输入要搜索的内容后，则界面只显示搜索到的内容，更加方便查看，例如：</p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210956_321.png" alt="Linux htop工具使用详解"></p>
<p><strong>F5:以树形方式显示</strong></p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210956_876.png" alt="Linux htop工具使用详解"></p>
<p><strong>F6：排序方式</strong></p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210956_8.png" alt="Linux htop工具使用详解"></p>
<p>按下F6后会跳转至上图界面，让您选择以什么方式进行排序,在Sort by下选择您要以什么来排序</p>
<p><strong>F7,F8：调整进程nice值</strong></p>
<p>F7表示减小nice值(增大优先级),F8增大nice值(减小优先级)，选择某一进程，按F7或F8来增大或减小nice值，nice值范围为-20-19，此处我把apache的nice值调整到了19</p>
<p><img src="http://static.open-open.com/lib/uploadImg/20141203/20141203210957_254.png" alt="Linux htop工具使用详解"></p>
<p><strong>F9：杀死进程</strong></p>
<p>选择某一进程按F9即可杀死此进程，很方便</p>
<p>F10:退出htop</p>
<p><strong>四．结束</strong></p>
<p>以上就是htop的基本用法，感谢您的观看，相信大家能够感觉到Htop比top的优势。如果有什么错误之处，麻烦留言告知，方便下次更改，谢谢。</p>
<p>参考文档<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/freeking101/article/details/79173903">https://blog.csdn.net/freeking101/article/details/79173903</a><br><a target="_blank" rel="noopener" href="http://www.open-open.com/lib/view/open1417612210323.html">http://www.open-open.com/lib/view/open1417612210323.html</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-03-08T10:44:54.000Z" title="2022/3/8 下午6:44:54">2022-03-08</time>发表</span><span class="level-item"><time dateTime="2022-08-30T02:23:13.453Z" title="2022/8/30 上午10:23:13">2022-08-30</time>更新</span><span class="level-item">11 分钟读完 (大约1660个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/08/%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E3%80%81%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9%E5%8C%BA%E5%88%AB%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">缓存穿透、缓存击穿、缓存雪崩区别和解决方案</a></h1><div class="content"><h1 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h1><ul>
<li>遭受攻击大量随机生成的key访问，或是真正访问但数据库就是没数据</li>
<li>上线前没有进行老数据缓存预加载，大量老数据请求去查询数据库</li>
<li>热点key失效，对热点key的并发访问大</li>
<li>缓存失效，过期时间设置相同同一时间有大量key失效</li>
<li>缓存挂掉，直接查数据库</li>
</ul>
<h1 id="缓存处理流程"><a href="#缓存处理流程" class="headerlink" title="缓存处理流程"></a>缓存处理流程</h1><p>前台请求，后台先从缓存中取数据，取到直接返回结果，取不到时从数据库中取，数据库取到更新缓存，并返回结果，数据库也没取到，那直接返回空结果。</p>
<h1 id="缓存穿透"><a href="#缓存穿透" class="headerlink" title="缓存穿透"></a>缓存穿透</h1><h2 id="描述："><a href="#描述：" class="headerlink" title="描述："></a>描述：</h2><p>缓存穿透是指缓存和数据库中都没有的数据，而用户不断发起请求，如发起为id为“-1”的数据或id为特别大不存在的数据。当用户很多的时候，缓存都没有命中，于是都去请求了持久层数据库。这会给持久层数据库造成很大的压力，这时候就相当于出现了缓存穿透。</p>
<blockquote>
<p>这里需要注意和缓存击穿的区别，缓存击穿，是指一个key非常热点，在不停的扛着大并发，大并发集中对这一个点进行访问，当这个key在失效的瞬间，持续的大并发就穿破缓存，直接请求数据库，就像在一个屏障上凿开了一个洞。</p>
</blockquote>
<h2 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h2><ul>
<li>接口层增加校验，如用户鉴权校验，id做基础校验，id&lt;&#x3D;0的直接拦截；</li>
<li>从缓存取不到的数据，在数据库中也没有取到，这时也可以将key-value对写为key-null，缓存有效时间可以设置短点，如30秒（设置太长会导致正常情况也没法使用）。这样可以防止攻击用户反复用同一个id暴力攻击<br><img src="/images/20220309/e03a5cbbc97c3bc08bbf058c48e135c2.jpeg"></li>
</ul>
<p>但是这种方法会存在两个问题：</p>
<ol>
<li>如果空值能够被缓存起来，这就意味着缓存需要更多的空间存储更多的键，因为这当中可能会有很多的空值的键；</li>
<li>即使对空值设置了过期时间，还是会存在缓存层和存储层的数据会有一段时间窗口的不一致，这对于需要保持一致性的业务会有影响。</li>
</ol>
<ul>
<li>布隆过滤器</li>
</ul>
<p>布隆过滤器是一种数据结构，垃圾网站和正常网站加起来全世界据统计也有几十亿个。网警要过滤这些垃圾网站，总不能到数据库里面一个一个去比较吧，这就可以使用布隆过滤器。假设我们存储一亿个垃圾网站地址。</p>
<p>可以先有一亿个二进制比特，然后网警用八个不同的随机数产生器（F1,F2, …,F8） 产生八个信息指纹（f1, f2, …, f8）。接下来用一个随机数产生器 G 把这八个信息指纹映射到 1 到1亿中的八个自然数 g1, g2, …,g8。最后把这八个位置的二进制全部设置为一。过程如下</p>
<p><img src="/images/20220309/4b34d93de755a0861d1e554e5c3e71ac.jpeg"><br>有一天网警查到了一个可疑的网站，想判断一下是否是XX网站，首先将可疑网站通过哈希映射到1亿个比特数组上的8个点。如果8个点的其中有一个点不为1，则可以判断该元素一定不存在集合中。</p>
<p>那这个布隆过滤器是如何解决redis中的缓存穿透呢？很简单首先也是对所有可能查询的参数以hash形式存储，当用户想要查询的时候，使用布隆过滤器发现不在集合中，就直接丢弃，不再对持久层查询。</p>
<p><img src="/images/20220309/4ab5c394716489101c445ec56504ee1f.jpeg"></p>
<h1 id="缓存击穿"><a href="#缓存击穿" class="headerlink" title="缓存击穿"></a>缓存击穿</h1><h2 id="描述：-1"><a href="#描述：-1" class="headerlink" title="描述："></a>描述：</h2><p>缓存击穿是指缓存中没有但数据库中有的数据（一般是缓存时间到期），这时由于并发用户特别多，同时读缓存没读到数据，又同时去数据库去取数据，引起数据库压力瞬间增大，造成过大压力</p>
<h2 id="解决方案：-1"><a href="#解决方案：-1" class="headerlink" title="解决方案："></a>解决方案：</h2><ul>
<li>设置热点数据永远不过期</li>
<li>加互斥锁</li>
</ul>
<h1 id="缓存雪崩"><a href="#缓存雪崩" class="headerlink" title="缓存雪崩"></a>缓存雪崩</h1><h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>缓存雪崩是指缓存中数据大批量到过期时间或者缓存层出现错误，大量查询到达存储层，而查询数据量巨大，引起数据库压力过大甚至down机。和缓存击穿不同的是，缓存击穿指并发查同一条数据，缓存雪崩是不同数据都过期了，很多数据都查不到从而查数据库。</p>
<p><img src="/images/20220309/3eeb41d79bd255c85ef61aedf0052315.jpeg"></p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><ul>
<li><p>缓存数据的过期时间设置随机，防止同一时间大量数据过期现象发生。</p>
</li>
<li><p>如果缓存数据库是分布式部署，将热点数据均匀分布在不同搞得缓存数据库中。</p>
</li>
<li><p>设置热点数据永远不过期。</p>
</li>
<li><p>redis高可用<br>这个思想的含义是，既然redis有可能挂掉，那我多增设几台redis，这样一台挂掉之后其他的还可以继续工作，其实就是搭建的集群。</p>
</li>
<li><p>限流降级<br>这个解决方案的思想是，在缓存失效后，通过加锁或者队列来控制读数据库写缓存的线程数量。比如对某个key只允许一个线程查询数据和写缓存，其他线程等待。</p>
</li>
<li><p>数据预热<br>数据加热的含义就是在正式部署之前，我先把可能的数据先预先访问一遍，这样部分可能大量访问的数据就会加载到缓存中。在即将发生大并发访问前手动触发加载缓存不同的key，设置不同的过期时间，让缓存失效的时间点尽量均匀。</p>
</li>
</ul>
<p>参考文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/kongtiao5/article/details/82771694">https://blog.csdn.net/kongtiao5/article/details/82771694</a></p>
<p><a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1655304940308056733&amp;wfr=spider&amp;for=pc">https://baijiahao.baidu.com/s?id=1655304940308056733&amp;wfr=spider&amp;for=pc</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-03-06T08:55:50.000Z" title="2022/3/6 下午4:55:50">2022-03-06</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.673Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">1 分钟读完 (大约220个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/06/%E4%B8%80%E4%BA%9BSEO%E7%9B%B8%E5%85%B3%E6%A0%87%E7%AD%BE/">一些SEO相关标签</a></h1><div class="content"><h1 id="Normal"><a href="#Normal" class="headerlink" title="Normal"></a>Normal</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=&quot;canonical&quot; href=&quot;https://music.163.com/&quot;&gt;</span><br><span class="line">&lt;meta name=description content=&quot;网易云音乐是一款专注于发现与分享的音乐产品，依托专业音乐人、DJ、好友推荐及社交功能，为用户打造全新的音乐生活。&quot;&gt;</span><br><span class="line">&lt;meta name=&quot;keywords&quot; content=&quot;网易云音乐，音乐，播放器，网易，下载，播放，DJ，免费，明星，精选，歌单，识别音乐，收藏，分享音乐，音乐互动，高音质，320K，音乐社交，官网，music.163.com&quot; /&gt;</span><br><span class="line">&lt;meta name=&quot;Author&quot; contect=&quot;CZQ&quot;&gt;</span><br></pre></td></tr></table></figure>

<h1 id="Robots"><a href="#Robots" class="headerlink" title="Robots"></a>Robots</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=&quot;Robots&quot; contect= &quot;all|none|index|noindex|follow|nofollow&quot;&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>设定为all：文件将被检索，且页面上的链接可以被查询；</li>
<li>设定为none：文件将不被检索，且页面上的链接不可以被查询；</li>
<li>设定为index：文件将被检索；</li>
<li>设定为follow：页面上的链接可以被查询；</li>
<li>设定为noindex：文件将不被检索，但页面上的链接可以被查询；</li>
<li>设定为nofollow：文件将不被检索，页面上的链接可以被查询</li>
</ul>
<h1 id="Open-Graph-Protocol"><a href="#Open-Graph-Protocol" class="headerlink" title="Open Graph Protocol"></a>Open Graph Protocol</h1><p> <code>og</code>是一种新的HTTP头部标记，作用是让网页成为一个“富媒体对象”。用了<code>Meta Property=og</code>标签，就是同意了其他网站可以引用本网页内容，目前这种协议被很多<code>SNS</code>网站采用。也就是所谓的富媒体对象。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta property=&quot;og:title&quot; content=&quot;网易云音乐&quot; /&gt;</span><br><span class="line">&lt;meta property=&quot;og:type&quot; content=&quot;website&quot; /&gt;</span><br><span class="line">&lt;meta property=&quot;og:image&quot; content=&quot;http://p3.music.126.net/tBTNafgjNnTL1KlZMt7lVA==/18885211718935735.jpg&quot; /&gt;</span><br><span class="line">&lt;meta property=&quot;og:url&quot; content=&quot;https://music.163.com/&quot; /&gt;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-03-06T06:09:39.000Z" title="2022/3/6 下午2:09:39">2022-03-06</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.673Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">13 分钟读完 (大约1933个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/06/Supervisor%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/">Supervisor使用详解</a></h1><div class="content"><h2 id="一、supervisor简介"><a href="#一、supervisor简介" class="headerlink" title="一、supervisor简介"></a>一、supervisor简介</h2><p>Supervisor是用Python开发的一套通用的进程管理程序，能将一个普通的命令行进程变为后台daemon，并监控进程状态，异常退出时能自动重启。它是通过fork&#x2F;exec的方式把这些被管理的进程当作supervisor的子进程来启动，这样只要在supervisor的配置文件中，把要管理的进程的可执行文件的路径写进去即可。也实现当子进程挂掉的时候，父进程可以准确获取子进程挂掉的信息的，可以选择是否自己启动和报警。supervisor还提供了一个功能，可以为supervisord或者每个子进程，设置一个非root的user，这个user就可以管理它对应的进程。</p>
<p><em>注：本文以centos7为例，supervisor版本3.4.0。</em></p>
<h2 id="二、supervisor安装"><a href="#二、supervisor安装" class="headerlink" title="二、supervisor安装"></a>二、supervisor安装</h2><ol>
<li><p>配置好yum源后，可以直接安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install supervisor</span><br></pre></td></tr></table></figure>
</li>
<li><p>Debian&#x2F;Ubuntu可通过apt安装</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="keyword">get</span> install supervisor</span><br></pre></td></tr></table></figure>
</li>
<li><p>pip安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install supervisor</span><br></pre></td></tr></table></figure>
</li>
<li><p>easy_install安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">easy_install supervisor</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="三、supervisor使用"><a href="#三、supervisor使用" class="headerlink" title="三、supervisor使用"></a>三、supervisor使用</h2><h5 id="supervisor配置文件：-etc-supervisord-conf"><a href="#supervisor配置文件：-etc-supervisord-conf" class="headerlink" title="supervisor配置文件：/etc/supervisord.conf"></a>supervisor配置文件：<code>/etc/supervisord.conf</code></h5><p><em>注：supervisor的配置文件默认是不全的，不过在大部分默认的情况下，上面说的基本功能已经满足。</em></p>
<h5 id="子进程配置文件路径：-etc-supervisord-d"><a href="#子进程配置文件路径：-etc-supervisord-d" class="headerlink" title="子进程配置文件路径：/etc/supervisord.d/"></a>子进程配置文件路径：<code>/etc/supervisord.d/</code></h5><p><em>注：默认子进程配置文件为ini格式，可在supervisor主配置文件中修改。</em></p>
<h2 id="四、配置文件说明"><a href="#四、配置文件说明" class="headerlink" title="四、配置文件说明"></a>四、配置文件说明</h2><h4 id="supervisor-conf配置文件说明："><a href="#supervisor-conf配置文件说明：" class="headerlink" title="supervisor.conf配置文件说明："></a>supervisor.conf配置文件说明：</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">[unix_http_server]</span><br><span class="line">file=/tmp/supervisor.sock   ;UNIX socket 文件，supervisorctl 会使用</span><br><span class="line">;chmod=<span class="number">0700</span>                 ;socket文件的mode，默认是<span class="number">0700</span></span><br><span class="line">;chown=nobody:nogroup       ;socket文件的owner，格式：uid:gid</span><br><span class="line"> </span><br><span class="line">;[inet_http_server]         ;HTTP服务器，提供web管理界面</span><br><span class="line">;port=<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">9001</span>        ;Web管理后台运行的IP和端口，如果开放到公网，需要注意安全性</span><br><span class="line">;username=user              ;登录管理后台的用户名</span><br><span class="line">;password=<span class="number">123</span>               ;登录管理后台的密码</span><br><span class="line"> </span><br><span class="line">[supervisord]</span><br><span class="line">logfile=/tmp/supervisord.log ;日志文件，默认是 $CWD/supervisord.log</span><br><span class="line">logfile_maxbytes=<span class="number">50</span>MB        ;日志文件大小，超出会rotate，默认 <span class="number">50</span>MB，如果设成<span class="number">0</span>，表示不限制大小</span><br><span class="line">logfile_backups=<span class="number">10</span>           ;日志文件保留备份数量默认<span class="number">10</span>，设为<span class="number">0</span>表示不备份</span><br><span class="line">loglevel=info                ;日志级别，默认info，其它: debug,warn,trace</span><br><span class="line">pidfile=/tmp/supervisord.pid ;pid 文件</span><br><span class="line">nodaemon=<span class="literal">false</span>               ;是否在前台启动，默认是<span class="literal">false</span>，即以 daemon 的方式启动</span><br><span class="line">minfds=<span class="number">1024</span>                  ;可以打开的文件描述符的最小值，默认 <span class="number">1024</span></span><br><span class="line">minprocs=<span class="number">200</span>                 ;可以打开的进程数的最小值，默认 <span class="number">200</span></span><br><span class="line"> </span><br><span class="line">[supervisorctl]</span><br><span class="line">serverurl=unix:<span class="comment">///tmp/supervisor.sock ;通过UNIX socket连接supervisord，路径与unix_http_server部分的file一致</span></span><br><span class="line">;serverurl=http:<span class="comment">//127.0.0.1:9001 ; 通过HTTP的方式连接supervisord</span></span><br><span class="line"> </span><br><span class="line">; [program:xx]是被管理的进程配置参数，xx是进程的名称</span><br><span class="line">[program:xx]</span><br><span class="line">command=/opt/apache-tomcat<span class="number">-8.0</span><span class="number">.35</span>/bin/catalina.sh run  ; 程序启动命令</span><br><span class="line">autostart=<span class="literal">true</span>       ; 在supervisord启动的时候也自动启动</span><br><span class="line">startsecs=<span class="number">10</span>         ; 启动<span class="number">10</span>秒后没有异常退出，就表示进程正常启动了，默认为<span class="number">1</span>秒</span><br><span class="line">autorestart=<span class="literal">true</span>     ; 程序退出后自动重启,可选值：[unexpected,<span class="literal">true</span>,<span class="literal">false</span>]，默认为unexpected，表示进程意外杀死后才重启</span><br><span class="line">startretries=<span class="number">3</span>       ; 启动失败自动重试次数，默认是<span class="number">3</span></span><br><span class="line">user=tomcat          ; 用哪个用户启动进程，默认是root</span><br><span class="line">priority=<span class="number">999</span>         ; 进程启动优先级，默认<span class="number">999</span>，值小的优先启动</span><br><span class="line">redirect_stderr=<span class="literal">true</span> ; 把stderr重定向到stdout，默认<span class="literal">false</span></span><br><span class="line">stdout_logfile_maxbytes=<span class="number">20</span>MB  ; stdout 日志文件大小，默认<span class="number">50</span>MB</span><br><span class="line">stdout_logfile_backups = <span class="number">20</span>   ; stdout 日志文件备份数，默认是<span class="number">10</span></span><br><span class="line">; stdout 日志文件，需要注意当指定目录不存在时无法正常启动，所以需要手动创建目录（supervisord 会自动创建日志文件）</span><br><span class="line">stdout_logfile=/opt/apache-tomcat<span class="number">-8.0</span><span class="number">.35</span>/logs/catalina.out</span><br><span class="line">stopasgroup=<span class="literal">false</span>     ;默认为<span class="literal">false</span>,进程被杀死时，是否向这个进程组发送stop信号，包括子进程</span><br><span class="line">killasgroup=<span class="literal">false</span>     ;默认为<span class="literal">false</span>，向进程组发送kill信号，包括子进程</span><br><span class="line"> </span><br><span class="line">;包含其它配置文件</span><br><span class="line">[include]</span><br><span class="line">files = relative/directory<span class="comment">/*.ini    ;可以指定一个或多个以.ini结束的配置文件</span></span><br></pre></td></tr></table></figure>

<h4 id="子进程配置文件说明："><a href="#子进程配置文件说明：" class="headerlink" title="子进程配置文件说明："></a>子进程配置文件说明：</h4><p>给需要管理的子进程(程序)编写一个配置文件，放在<code>/etc/supervisor.d/</code>目录下，以<code>.ini</code>作为扩展名（每个进程的配置文件都可以单独分拆也可以把相关的脚本放一起）。如任意定义一个和脚本相关的项目名称的选项组（&#x2F;etc&#x2F;supervisord.d&#x2F;test.conf）：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#项目名</span></span><br><span class="line">[<span class="symbol">program:</span>blog]</span><br><span class="line"><span class="comment">#脚本目录</span></span><br><span class="line">directory=<span class="regexp">/opt/bin</span></span><br><span class="line"><span class="comment">#脚本执行命令</span></span><br><span class="line">command=<span class="regexp">/usr/bin</span><span class="regexp">/python /opt</span><span class="regexp">/bin/test</span>.py</span><br><span class="line"></span><br><span class="line"><span class="comment">#supervisor启动的时候是否随着同时启动，默认True</span></span><br><span class="line">autostart=<span class="literal">true</span></span><br><span class="line"><span class="comment">#当程序exit的时候，这个program不会自动重启,默认unexpected，设置子进程挂掉后自动重启的情况，有三个选项，false,unexpected和true。如果为false的时候，无论什么情况下，都不会被重新启动，如果为unexpected，只有当进程的退出码不在下面的exitcodes里面定义的</span></span><br><span class="line">autorestart=<span class="literal">false</span></span><br><span class="line"><span class="comment">#这个选项是子进程启动多少秒之后，此时状态如果是running，则我们认为启动成功了。默认值为1</span></span><br><span class="line">startsecs=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#脚本运行的用户身份 </span></span><br><span class="line">user = test</span><br><span class="line"></span><br><span class="line"><span class="comment">#日志输出 </span></span><br><span class="line">stderr_logfile=<span class="regexp">/tmp/blog</span>_stderr.log </span><br><span class="line">stdout_logfile=<span class="regexp">/tmp/blog</span>_stdout.log </span><br><span class="line"><span class="comment">#把stderr重定向到stdout，默认 false</span></span><br><span class="line">redirect_stderr = <span class="literal">true</span></span><br><span class="line"><span class="comment">#stdout日志文件大小，默认 50MB</span></span><br><span class="line">stdout_logfile_maxbytes = 20MB</span><br><span class="line"><span class="comment">#stdout日志文件备份数</span></span><br><span class="line">stdout_logfile_backups = <span class="number">20</span></span><br></pre></td></tr></table></figure>

<h5 id="子进程配置示例："><a href="#子进程配置示例：" class="headerlink" title="子进程配置示例："></a>子进程配置示例：</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#说明同上</span></span><br><span class="line">[program:<span class="built_in">test</span>] </span><br><span class="line">directory=/opt/bin </span><br><span class="line"><span class="built_in">command</span>=/opt/bin/test</span><br><span class="line">autostart=<span class="literal">true</span> </span><br><span class="line">autorestart=<span class="literal">false</span> </span><br><span class="line">stderr_logfile=/tmp/test_stderr.log </span><br><span class="line">stdout_logfile=/tmp/test_stdout.log </span><br><span class="line"><span class="comment">#user = test  </span></span><br></pre></td></tr></table></figure>

<h2 id="五、supervisor命令说明"><a href="#五、supervisor命令说明" class="headerlink" title="五、supervisor命令说明"></a>五、supervisor命令说明</h2><h5 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">supervisorctl status        <span class="comment">//查看所有进程的状态</span></span><br><span class="line">supervisorctl stop es       <span class="comment">//停止es</span></span><br><span class="line">supervisorctl start es      <span class="comment">//启动es</span></span><br><span class="line">supervisorctl restart       <span class="comment">//重启es</span></span><br><span class="line">supervisorctl update        <span class="comment">//配置文件修改后使用该命令加载新的配置</span></span><br><span class="line">supervisorctl reload        <span class="comment">//重新启动配置中的所有程序</span></span><br></pre></td></tr></table></figure>

<p>注：把<code>es</code>换成<code>all</code>可以管理配置中的所有进程。直接输入<code>supervisorctl</code>进入supervisorctl的shell交互界面，此时上面的命令不带supervisorctl可直接使用。</p>
<h5 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h5><p>使用supervisor进程管理命令之前先启动supervisord，否则程序报错。<br> 使用命令<code>supervisord -c /etc/supervisord.conf</code>启动。<br> 若是centos7：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl start supervisord.service     <span class="comment">//启动supervisor并加载默认配置文件</span></span><br><span class="line">systemctl enable supervisord.service    <span class="comment">//将supervisor加入开机启动项</span></span><br></pre></td></tr></table></figure>

<h5 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h5><ol>
<li>unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;supervisor.sock no such file<br> 问题描述：安装好supervisor没有开启服务直接使用supervisorctl报的错<br> 解决办法：<code>supervisord -c /etc/supervisord.conf</code></li>
<li>command中指定的进程已经起来，但supervisor还不断重启<br> 问题描述：command中启动方式为后台启动，导致识别不到pid，然后不断重启，这里使用的是elasticsearch，command指定的是<code>$path/bin/elasticsearch -d</code><br> 解决办法：supervisor无法检测后台启动进程的pid，而supervisor本身就是后台启动守护进程，因此不用担心这个</li>
<li>启动了多个supervisord服务，导致无法正常关闭服务<br> 问题描述：在运行<code>supervisord -c /etc/supervisord.conf</code>之前，直接运行过<code>supervisord -c /etc/supervisord.d/xx.conf</code>导致有些进程被多个superviord管理，无法正常关闭进程。<br> 解决办法：使用<code>ps -fe | grep supervisord</code>查看所有启动过的supervisord服务，kill相关的进程。</li>
</ol>
<h5 id="更多信息请移步Supervisor官网：http-supervisord-org"><a href="#更多信息请移步Supervisor官网：http-supervisord-org" class="headerlink" title="更多信息请移步Supervisor官网：http://supervisord.org"></a>更多信息请移步Supervisor官网：<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=http://supervisord.org">http://supervisord.org</a></h5><p>来源： <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/0b9054b33db3">Supervisor使用详解 - 简书 (jianshu.com)</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-02-12T01:55:38.000Z" title="2022/2/12 上午9:55:38">2022-02-12</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.673Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">几秒读完 (大约47个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/02/12/%E5%AE%89%E8%A3%85Ubuntu%E5%90%8E%E5%8F%A6%E5%A4%96%E7%A3%81%E7%9B%98%E5%87%BA%E7%8E%B0%E5%8F%AA%E8%AF%BB%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/">安装Ubuntu后另外磁盘出现只读的解决办法</a></h1><div class="content"><p>mount<br>blkid<br>sudo ntfsfix &#x2F;dev&#x2F;sdb1<br>mount -a</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="卸载硬盘："><a href="#卸载硬盘：" class="headerlink" title="卸载硬盘："></a>卸载硬盘：</h3><p>chen@ilaptop:&#x2F;$ sudo umount &#x2F;dev&#x2F;sdb1</p>
<h3 id="读写挂载硬盘"><a href="#读写挂载硬盘" class="headerlink" title="读写挂载硬盘"></a>读写挂载硬盘</h3><p>chen@ilaptop:&#x2F;$ sudo mount -o rw &#x2F;dev&#x2F;sdb1</p>
<p>参考：<a target="_blank" rel="noopener" href="https://jakting.com/archives/ubuntu-rw-windows-files.html">https://jakting.com/archives/ubuntu-rw-windows-files.html</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-01-23T07:56:30.000Z" title="2022/1/23 下午3:56:30">2022-01-23</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.673Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">3 分钟读完 (大约511个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/23/RabbitMQ%E5%AE%89%E8%A3%85/">RabbitMQ安装</a></h1><div class="content"><h1 id="Docker安装RabbitMQ"><a href="#Docker安装RabbitMQ" class="headerlink" title="Docker安装RabbitMQ"></a>Docker安装RabbitMQ</h1><h2 id="下载镜像"><a href="#下载镜像" class="headerlink" title="下载镜像"></a>下载镜像</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull rabbitmq:management  #management标签的含义是下载的镜像包含manage模块。包含web管理页面。</span><br></pre></td></tr></table></figure>

<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -dit --name myrabbitmq -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_DEFAULT_PASS=admin -p 15672:15672 -p 5672:5672 rabbitmq:management</span><br></pre></td></tr></table></figure>

<p><code> -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_DEFAULT_PASS=admin</code>指定<code>manage</code>模块的用户名和密码，我执行完后是报错的，也可以完全省略参数。<br>如果不指定默认用户名密码，系统会有默认用户名密码：<code>guest </code> <code>guest</code><br>所以，可以用下面命令。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --hostname my-rabbit --name rabbit -p 15672:15672 -p 5673:5672 rabbitmq:management</span><br></pre></td></tr></table></figure>

<p>现在可以通过访问<a href="http://linuxip:15672，访问web界面，这里的用户名和密码默认都是guest。">http://linuxip:15672，访问web界面，这里的用户名和密码默认都是guest。</a></p>
<h2 id="如果访问失败，可能是没有开启manage模块。"><a href="#如果访问失败，可能是没有开启manage模块。" class="headerlink" title="如果访问失败，可能是没有开启manage模块。"></a>如果访问失败，可能是没有开启manage模块。</h2><p>通过<code>docker ps -a</code>查看部署的<code>mq</code>容器<code>id</code>，在通过 <code>docker exec -it 容器id /bin/bssh</code> 进入容器内部在<br>运行：<code>rabbitmq-plugins enable rabbitmq_management</code>，执行完毕后重新访问web界面即可。</p>
<p>原文地址：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/chenxizhaolu/p/15145488.html">docker安装rabbitmq - chenxizhaolu - 博客园 (cnblogs.com)</a></p>
<h1 id="Ubuntu18-04安装RabbitMQ"><a href="#Ubuntu18-04安装RabbitMQ" class="headerlink" title="Ubuntu18.04安装RabbitMQ"></a>Ubuntu18.04安装RabbitMQ</h1><h2 id="安装erlang"><a href="#安装erlang" class="headerlink" title="安装erlang"></a>安装erlang</h2><p>由于<code>rabbitMq</code>需要<code>erlang</code>语言的支持，在安装r<code>abbitMq</code>之前需要安装<code>erlang</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install erlang-nox</span><br></pre></td></tr></table></figure>

<h2 id="安装Rabbitmq"><a href="#安装Rabbitmq" class="headerlink" title="安装Rabbitmq"></a>安装Rabbitmq</h2><p>更新源</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>

<p>安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install rabbitmq-server</span><br></pre></td></tr></table></figure>

<p>启动、停止、重启、状态<code>RabbitMQ</code>命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo rabbitmq-server start </span><br><span class="line">sudo rabbitmq-server stop</span><br><span class="line">sudo rabbitmq-server restart</span><br><span class="line">sudo rabbitmqctl status</span><br></pre></td></tr></table></figure>

<h2 id="添加admin，并赋予administrator权限"><a href="#添加admin，并赋予administrator权限" class="headerlink" title="添加admin，并赋予administrator权限"></a>添加admin，并赋予administrator权限</h2><p>添加admin用户，密码设置为admin。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rabbitmqctl add_user  admin  admin  </span><br></pre></td></tr></table></figure>

<p>赋予权限</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rabbitmqctl set_user_tags admin administrator </span><br></pre></td></tr></table></figure>

<p>赋予virtual host中所有资源的配置、写、读权限以便管理其中的资源</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rabbitmqctl  set_permissions -p / admin <span class="string">&#x27;.*&#x27;</span> <span class="string">&#x27;.*&#x27;</span> <span class="string">&#x27;.*&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Web管理器连接"><a href="#Web管理器连接" class="headerlink" title="Web管理器连接"></a>Web管理器连接</h2><p>浏览器访问<a target="_blank" rel="noopener" href="http://192.168.3.45:15672/">http://192.168.1.42:15672</a></p>
<p><a target="_blank" rel="noopener" href="https://img-blog.csdn.net/20180610200515165"><img src="https://img-blog.csdn.net/20180610200515165" alt="img"></a></p>
<p>使用刚刚创建的admin就可以登录，密码也为admin</p>
<p> 原文地址：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ellisonzhang/p/15102942.html">Ubuntu18.04安装RabbitMQ - Ellisonzhang - 博客园 (cnblogs.com)</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-01-05T13:32:42.000Z" title="2022/1/5 下午9:32:42">2022-01-05</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.673Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">14 分钟读完 (大约2116个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/05/RBAC%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E5%88%86%E6%9E%90%E3%80%81%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/">RBAC权限系统分析、设计与实现</a></h1><div class="content"><p>转载请备注来源： <a target="_blank" rel="noopener" href="https://shuwoom.com/?p=3041">《RBAC权限系统分析、设计与实现》</a> | <a target="_blank" rel="noopener" href="http://shuwoom.com/">shuwoom.com</a></p>
<p>最近，因为项目上需要设计实现一个权限管理模块，所以专门整理总结了RBAC的一些知识。</p>
<p>目前，使用最普遍的权限管理模型正是RBAC（Role-Based Access Control）模型，这篇文章也主要是介绍基于RBAC的权限管理系统，我会从RBAC是什么、如何设计RBAC两部分来介绍。</p>
<h1 id="一、RBAC是什么"><a href="#一、RBAC是什么" class="headerlink" title="一、RBAC是什么"></a>一、RBAC是什么</h1><h2 id="1、RBAC模型概述"><a href="#1、RBAC模型概述" class="headerlink" title="1、RBAC模型概述"></a>1、RBAC模型概述</h2><p>RBAC模型（Role-Based Access Control：基于角色的访问控制）模型是20世纪90年代研究出来的一种新模型，但其实在20世纪70年代的多用户计算时期，这种思想就已经被提出来，直到20世纪90年代中后期，RBAC才在研究团体中得到一些重视，并先后提出了许多类型的RBAC模型。其中以美国George Mason大学信息安全技术实验室（LIST）提出的<a target="_blank" rel="noopener" href="https://www.profsandhu.com/infs767/infs767fall03/lecture01-2.pdf">RBAC96</a>模型最具有代表，并得到了普遍的公认。</p>
<p>RBAC认为权限授权的过程可以抽象地概括为：Who是否可以对What进行How的访问操作，并对这个逻辑表达式进行判断是否为True的求解过程，也即是将权限问题转换为What、How的问题，Who、What、How构成了访问权限三元组，具体的理论可以参考RBAC96的论文，这里我们就不做详细的展开介绍，大家有个印象即可。</p>
<h2 id="2、RBAC的组成"><a href="#2、RBAC的组成" class="headerlink" title="2、RBAC的组成"></a>2、RBAC的组成</h2><p>在RBAC模型里面，有3个基础组成部分，分别是：用户、角色和权限。</p>
<p>RBAC通过定义角色的权限，并对用户授予某个角色从而来控制用户的权限，实现了用户和权限的逻辑分离（区别于ACL模型），极大地方便了权限的管理</p>
<p>下面在讲解之前，先介绍一些名词：</p>
<ul>
<li>User（用户）：每个用户都有唯一的UID识别，并被授予不同的角色</li>
<li>Role（角色）：不同角色具有不同的权限</li>
<li>Permission（权限）：访问权限</li>
<li>用户-角色映射：用户和角色之间的映射关系</li>
<li>角色-权限映射：角色和权限之间的映射</li>
</ul>
<p>它们之间的关系如下图所示：</p>
<p><img src="https://shuwoom.com/wp-content/uploads/2019/04/rbacrole-based-access-control-1.png" alt="img"></p>
<p>例如下图，管理员和普通用户被授予不同的权限，普通用户只能去修改和查看个人信息，而不能创建创建用户和冻结用户，而管理员由于被授 予所有权限，所以可以做所有操作。</p>
<p>例如下图，管理员和普通用户被授予不同的权限，普通用户只能去修改和查看个人信息，而不能创建创建用户和冻结用户，而管理员由于被授予所有权限，所以可以做所有操作。</p>
<p><img src="https://shuwoom.com/wp-content/uploads/2019/04/rbac-demo.png" alt="rbac说明图"></p>
<h2 id="3、RBAC支持的安全原则"><a href="#3、RBAC支持的安全原则" class="headerlink" title="3、RBAC支持的安全原则"></a>3、RBAC支持的安全原则</h2><p>RBAC支持三个著名的安全原则：最小权限原则、责任分离原则和数据抽象原则</p>
<ul>
<li>最小权限原则：RBAC可以将角色配置成其完成任务所需的最小权限集合</li>
<li>责任分离原则：可以通过调用相互独立互斥的角色来共同完成敏感的任务，例如要求一个计账员和财务管理员共同参与统一过账操作</li>
<li>数据抽象原则：可以通过权限的抽象来体现，例如财务操作用借款、存款等抽象权限，而不是使用典型的读、写、执行权限</li>
</ul>
<h2 id="4、RBAC的优缺点"><a href="#4、RBAC的优缺点" class="headerlink" title="4、RBAC的优缺点"></a>4、RBAC的优缺点</h2><p>（1）优点：</p>
<ul>
<li>简化了用户和权限的关系</li>
<li>易扩展、易维护</li>
</ul>
<p>（2）缺点：</p>
<ul>
<li>RBAC模型没有提供操作顺序的控制机制，这一缺陷使得RBAC模型很难适应哪些对操作次序有严格要求的系统</li>
</ul>
<h2 id="5、RBAC的3种模型"><a href="#5、RBAC的3种模型" class="headerlink" title="5、RBAC的3种模型"></a>5、RBAC的3种模型</h2><h3 id="（1）RBAC0"><a href="#（1）RBAC0" class="headerlink" title="（1）RBAC0"></a>（1）RBAC0</h3><p>RBAC0，是最简单、最原始的实现方式，也是其他RBAC模型的基础。</p>
<p><img src="https://shuwoom.oss-cn-beijing.aliyuncs.com/rbac0.png" alt="rbac0模型图"></p>
<p>在该模型中，用户和角色之间可以是多对多的关系，即一个用户在不同场景下是可以有不同的角色，例如：项目经理也可能是组长也可能是架构师。同时每个角色都至少有一个权限。这种模型下，用户和权限被分离独立开来，使得权限的授权认证更加灵活。</p>
<h3 id="（2）RBAC1"><a href="#（2）RBAC1" class="headerlink" title="（2）RBAC1"></a>（2）RBAC1</h3><p>基于RBAC0模型，引入了角色间的继承关系，即角色上有了上下级的区别。</p>
<p><img src="https://shuwoom.oss-cn-beijing.aliyuncs.com/rbac1.png" alt="rbac1模型图"></p>
<p>角色间的继承关系可分为一般继承关系和受限继承关系。一般继承关系仅要求角色继承关系是一个绝对偏序关系，允许角色间的多继承。而受限继承关系则进一步要求角色继承关系是一个树结构，实现角色间的单继承。</p>
<p>这种模型适合于角色之间层次分明，可以给角色分组分层。</p>
<h3 id="（3）RBAC2"><a href="#（3）RBAC2" class="headerlink" title="（3）RBAC2"></a>（3）RBAC2</h3><p>RBAC2，基于RBAC0模型的基础上，进行了角色的访问控制。</p>
<p><img src="https://shuwoom.oss-cn-beijing.aliyuncs.com/rbac2.png" alt="rbac2模型图"></p>
<p>RBAC2中的一个基本限制是互斥角色的限制，互斥角色是指各自权限可以互相制约的两个角色。对于这类角色一个用户在某一次活动中只能被分配其中的一个角色，不能同时获得两个角色的使用权。</p>
<p>该模型有以下几种约束：</p>
<ul>
<li>互斥角色 ：同一用户只能分配到一组互斥角色集合中至多一个角色，支持责任分离的原则。互斥角色是指各自权限互相制约的两个角色。对于这类角色一个用户在某一次活动中只能被分配其中的一个角色，不能同时获得两个角色的使用权。常举的例子：在审计活动中，一个角色不能同时被指派给会计角色和审计员角色。</li>
<li>基数约束 ：一个角色被分配的用户数量受限；一个用户可拥有的角色数目受限；同样一个角色对应的访问权限数目也应受限，以控制高级权限在系统中的分配。例如公司的领导人有限的；</li>
<li>先决条件角色 ：可以分配角色给用户仅当该用户已经是另一角色的成员；对应的可以分配访问权限给角色，仅当该角色已经拥有另一种访问权限。指要想获得较高的权限，要首先拥有低一级的权限。就像我们生活中，国家主席是从副主席中选举的一样。</li>
<li>运行时互斥 ：例如，允许一个用户具有两个角色的成员资格，但在运行中不可同时激活这两个角色。</li>
</ul>
<h1 id="二、如何设计RBAC"><a href="#二、如何设计RBAC" class="headerlink" title="二、如何设计RBAC"></a>二、如何设计RBAC</h1><p>这一节，我会介绍设计基于RBAC模型的权限系统的功能模块组成、流程以及数据库的设计。</p>
<h2 id="1、RBAC的功能模块"><a href="#1、RBAC的功能模块" class="headerlink" title="1、RBAC的功能模块"></a>1、RBAC的功能模块</h2><p><img src="https://shuwoom.oss-cn-beijing.aliyuncs.com/RBAC%E6%A8%A1%E5%9D%97%E5%8A%9F%E8%83%BD.png" alt="rbac功能模块"></p>
<h2 id="2、RBAC执行流程"><a href="#2、RBAC执行流程" class="headerlink" title="2、RBAC执行流程"></a>2、RBAC执行流程</h2><p><img src="https://shuwoom.oss-cn-beijing.aliyuncs.com/RBAC%E6%B5%81%E7%A8%8B.png" alt="rbac执行流程"></p>
<h2 id="3、RBAC数据库设计"><a href="#3、RBAC数据库设计" class="headerlink" title="3、RBAC数据库设计"></a>3、RBAC数据库设计</h2><p><img src="https://shuwoom.oss-cn-beijing.aliyuncs.com/rbac%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1.png" alt="rbac数据库设计"></p>
<p>转载请备注来源： <a target="_blank" rel="noopener" href="https://shuwoom.com/?p=3041">《RBAC权限系统分析、设计与实现》</a> | <a target="_blank" rel="noopener" href="http://shuwoom.com/">shuwoom.com ﻿</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-01-02T08:14:47.000Z" title="2022/1/2 下午4:14:47">2022-01-02</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.673Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">12 分钟读完 (大约1834个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/02/%E5%AE%9A%E4%B8%AA%E7%9B%AE%E6%A0%87/">定个目标</a></h1><div class="content"><ul>
<li>TCP&#x2F;UDP协议， socket 通信，熟练使用workman，swoole，swoft等rpc框架</li>
<li>精通PHP，熟悉golang语言，</li>
<li>熟悉html，css，javascript，会nodejs，vue,reactor,flutter。</li>
<li>mysql， 以及SQL优化，熟悉索引应用和优化，独立设计数据库、数据表，</li>
<li>nosql，mongodb， redis，memcache缓存。熟悉后端缓存技术、了解缓存使用场景，高并发、高性能服务系统设计经验及能力，熟悉大规模集群系统的开发</li>
<li>常用Linux，shell命令编写，熟悉云、容器使用</li>
<li>精通LNMP架构，熟悉http 协议，RestFul API开发，熟悉tp，laravel，yii主流框架。</li>
<li>熟练使用svn，git，Hg版本管理工具，</li>
<li>良好的书写习惯，注释，设计模式，编写高质量的，整洁简单，可维护性的代码，遵循公司研发规范，产品技术文档的整理</li>
<li>分析和快速排查定位解决线上问题，保障系统功能的稳定性，优化现有系统，提升运作性能</li>
<li>主导&#x2F;参与项目的架构设计、技术选型、架构原型实现以及服务端核心模块的开发，与各技术人员紧密合作，完成工作任务</li>
<li>有个人博客，个人开源项目，有个人独立完成项目。</li>
<li>乐于持续学习，乐观开朗，抗压性强，良好的沟通能力和合作精神，自我驱动力强，有强烈的事业心和责任感</li>
</ul>
<p>‌极光推送，信鸽<br>curlopt_resolve  <a target="_blank" rel="noopener" href="https://curl.se/libcurl/c/CURLOPT_RESOLVE.html">https://curl.se/libcurl/c/CURLOPT_RESOLVE.html</a><br>kafka&#x2F;redis<br>ribbitmq<br>grant revoke  flush previliges<br>防火墙，udp<br>seespeed<br>socket<br>pthread<br>openwrt<br>transactionxa<br>sql临时表<br>with as<br>游标查询<br>script放到body前，可以用async或者defer module<br>find_in_set field ,field,coalesce<br>bom头<br>廖雪峰官方网站<br>c malloc memset<br>sysbench<br>supervisor<br>webman<br>zabbix<br>trivial<br>QPS大于1000不要用redis的乐观锁watch<br>线程锁<br>多台机器用分布式锁，结合lua<br>10w QPS REDIS web容易挂。全量复制，部分复制，<br>redis主从 &gt; redis哨兵 &gt; redis 集群<br>数据槽<br>redis水平扩容1000个，每个10w。高可用集群<br>silent 沉默的，不说话的，<br>多字段唯一索引<br>redis休眠<br>发布消息得到锁<br>看门狗<br>需虚数和复数<br>二叉树红黑树<br>异或<br>hadoop<br>用ob_flush 导出大数据，边导出边下载。<br>算法导论<br>workman webman<br>count字段忽略空值，count(*&#x2F;1)不忽略<br>error_log<br>记忆犹新的问题，遇到问题，团队协作解决。<br>c函数内要返回的参数要用static<br>overflow-wrap: anywhere<br>throttling 使窒息，掐死<br>inner join无需关心顺序，数据库自动选<br>show processlist<br>awkward尴尬的<br>cringe<br>not in里面不能有null<br>延迟boot函数的执行，当从容器中取实例的时候才会boot<br>mutex 互斥锁<br>routine 正常顺序，常规<br>a&#x3D;(a+1)%2<br>0.1互换<br>external<br>set @name&#x3D;1<br>select @@sql_mode<br>selecr @name<br>show variables like ‘%sql_mode%’<br>seized<br>database 可以order by null<br>coalesce<br>sql添加排序列<br>dummy<br>table-cell<br>portable<br>curl_multi_init<br>源码安装php后扩展不能用php -m看<br>ctrl shift c 快速选中元素<br>‘123’[1]<br>怎么搭建邮件服务器，自己zabbix监视<br>countif<br>linux防火墙<br>malloc realloc<br>server alias<br>closest<br>er图，关系图<br>表定义，建表语句，<br>业务流程<br>grant on all tables<br>“transaction” in document.body.style<br>toggleClass<br>beautifulSoup<br>watchdog<br>ABCDE类人才<br>正则表达式断言<br>多路复用<br>size_t<br>pcntl<br>php ctype扩展</p>
<p>属性选择器<br>nethogs<br>erp<br>云原生<br>github1s<br>catchsegv gdb objdump<br>redis可读可写只维护一个<br>ldcx<br>sql top命令<br>nothing else matters</p>
<p>slice底层结构<br>%#v打印结构体<br>map实现原理，结构体json<br>闭包递归<br>defer ，单元测试，压力测试<br>函数内部函数被外部变量引用，就形成了闭包<br>数据结构算法<br>方法集<br>vega<br>切面编程<br>git推送到指定分支<br>redisgeo<br>splpriorityqueue<br>dcat<br>imagick<br>vuepress</p>
<p>mail docker<br>机翼构造<br>toml<br>yaml<br>状态转换图<br>猪油，蒜蓉，猴菇米稀<br>screenfetch<br>phpstream<br>领悟驱动设计<br>微服务架构设计模式<br>泛型三大特征，模板编程，类型安全，值类型计算<br>退出多层使用label<br>modstart<br>fastadmin<br>l5 repository<br>eolinker<br>nginx-lua<br>注册回调<br>分布式事务锁<br>令牌桶，雪花算法<br>下载分页，限流，登录控制器<br>ipv6访问要给ip加上中括号，例如[::1]:8199<br>imagemagic 和ffmpeg<br>二进制安全<br>redis egeo<br>trtc<br>flink spark<br>ps aft<br>risk指令集，<br>directly直接的<br>code .可以在当前目录打开vscode<br>寻址路由，数据链路，分片，序列码，封装，拥塞控制，错误检验和矫正，数据重发，重组<br>osi七层模型<br>range断点续传<br> 304<br>hybrid app electron crodova<br>以太网 tcp udp http http2 http<br>hsla颜色 backdrop-filter<br>urban dictionary<br>dart，kotlin<br>domdocument对象 php<br>domxpath<br>file对象可以用slice切块<br>auth rbac<br>php 花括号访问字符串是按照字节算，和golang一致<br>信号量<br>mail<br>think-scout<br>软考<br>if判断把几率大的放前面<br>shell<br>js模板语法使用模板字符，${a} 使用变量，方法，函数的立即调用模式!，对象的属性，用反引号括字符串<br>css媒体查询<br>substitute中匹配换行<br>正则\z Z b B </p>
<p>sql的group by 用法<br>canvas flex布局 cropper<br>escapeshellarg<br>使用箭头函数 不使用use ，按作用域隐式绑定<br>虾滑鱼滑<br>tmpwatch<br>awk<br>grep -q<br>export<br>substring(from to)<br>多行结果拼接<br>sql的case when<br>substring<br>substr<br>for xml path<br>preg_quote<br>阿帕奇location用正则断言匹配，rewritecond用!来匹配非<br>$GLOBALS为一个超全局数组，数组内包含所有全局变量<br>es6解构赋值<br>realpath<br>array_intersect_key<br>array_walk_recursive<br>command  key(end())<br> filter_vars<br> pjax<br>正则Ui和.*?非贪婪<br>in 会全表扫描，exists<br>join数据量小的放前面<br>whereOr  exist<br>chroot<br>phpize<br>getopt<br>后向引用<br> whoami<br>flutter<br>dig<br>limit不同当order字段全部相同的时候会导致排序不同<br>存储桶<br>codelf<br>正则表达式的(aaa|bbb)<br>substitute可以使用反斜线来换行<br>机—电<br>php – python — c<br>stat head<br>crontab<br>du -sh<br>正则u修饰<br>realpath<br>nth-child odd 背景颜色 代码块<br>sql extract函数<br>preg_quote<br>xhr.readyState xhr.setRequestHeader() 在open后<br>date back to<br>css动画的infinite可以无限循环<br>mysql分布式事务xa<br>concat concat_ws 可以用在and后<br>mb_ereg_replace<br>zh.osdn.net<br>jq的stop可以停止当前的动画<br>menual.51yip.com<br>pdo持久链<br>linux的find命令<br>css的behavior属性<br>ssi模块<br>pwd -P<br>骏马金龙<br>hadoop<br>take a rain check<br>area标签<br>distinct on<br>查看特定文件大小，总<br>pygame<br>存储过程<br>replaceall不要用，用replace(&#x2F;&#x2F;g)<br>array_reduce<br>jemeter ant  jenkins<br>waf<br>匿名函数接收回调传递给函<br>csp<br>preg_quote<br>posix_kill<br>file函数<br>涉及浮点数的要用bcmath<br>dump自动生成provider和command的缓存文件<br>fpm用tcp不要用unix 极端情况可能不行<br>strtok<br>流程图<br>memset<br>psql的having中可以用count()统计<br>vim ctrl v和 v<br>declare xxx cursor for (select )游标查询<br>js轮播图和点击滚动到顶部<br>vim分屏<br>判断是否是真实图片可以用getimagesize<br>diff<br>logrotate<br>sql round<br>《编码》</p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/4/">上一页</a></div><div class="pagination-next"><a href="/page/6/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/4/">4</a></li><li><a class="pagination-link is-current" href="/page/5/">5</a></li><li><a class="pagination-link" href="/page/6/">6</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/17/">17</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/images/avatar.jpg" alt="程"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">程</p><p class="is-size-6 is-block">未至精疲力尽，不要怨天尤人。昨日因，今日果。今日为，明日果也！</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Earth</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">169</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/tab-engineer" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/tab-engineer"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-01T06:56:20.000Z">2022-10-01</time></p><p class="title"><a href="/2022/10/01/tcpdump%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/">tcpdump详细教程</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-09-18T05:06:34.000Z">2022-09-18</time></p><p class="title"><a href="/2022/09/18/Typescript%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">Typescript学习笔记</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-09-04T13:30:39.000Z">2022-09-04</time></p><p class="title"><a href="/2022/09/04/Go%E5%90%84%E6%97%B6%E9%97%B4%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E8%A7%A3%E6%9E%90/">Go各时间字符串的解析</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-08-21T02:56:27.000Z">2022-08-21</time></p><p class="title"><a href="/2022/08/21/%E7%89%88%E6%9C%AC%E5%8F%B7%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83/">版本号命名规范</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-08-19T12:54:39.000Z">2022-08-19</time></p><p class="title"><a href="/2022/08/19/Markdown%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/">Markdown基本语法</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">十月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">九月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">八月 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">七月 2022</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">六月 2022</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">五月 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">四月 2022</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">三月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">二月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">一月 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">十二月 2021</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">七月 2021</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">六月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">四月 2021</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">三月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">二月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">十二月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">十一月 2020</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">十月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/08/"><span class="level-start"><span class="level-item">八月 2020</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/07/"><span class="level-start"><span class="level-item">七月 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><!--!--></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/avatar.jpg" alt="笔记" height="28"></a><p class="is-size-7"><span>&copy; 2022 CY</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>