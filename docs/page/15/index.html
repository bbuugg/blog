<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>笔记</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="笔记"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="笔记"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="笔记"><meta property="og:type" content="blog"><meta property="og:title" content="笔记"><meta property="og:url" content="https://www.chengyao.xyz/"><meta property="og:site_name" content="笔记"><meta property="og:description" content="笔记"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.chengyao.xyz/img/og_image.png"><meta property="article:author" content="CY"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://www.chengyao.xyz/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.chengyao.xyz"},"headline":"笔记","image":["https://www.chengyao.xyz/img/og_image.png"],"author":{"@type":"Person","name":"CY"},"publisher":{"@type":"Organization","name":"笔记","logo":{"@type":"ImageObject","url":"https://www.chengyao.xyz/images/avatar.jpg"}},"description":"笔记"}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(location.hash);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/avatar.jpg" alt="笔记" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/tab-engineer"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-11-19T12:20:36.000Z" title="2020/11/19 下午8:20:36">2020-11-19</time>发表</span><span class="level-item"><time dateTime="2022-09-18T01:41:54.952Z" title="2022/9/18 上午9:41:54">2022-09-18</time>更新</span><span class="level-item">9 分钟读完 (大约1351个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/11/19/jQuery%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">jQuery 学习笔记</a></h1><div class="content"><h1 id="去除表单空值"><a href="#去除表单空值" class="headerlink" title="去除表单空值"></a>去除表单空值</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(&quot;input&quot;, &quot;#submForm&quot;).each(function()&#123;</span><br><span class="line">	$(this).val() == &quot;&quot; &amp;&amp; $(this).remove();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&quot;input:text[value=&quot;&quot;]&quot;, &quot;#submForm&quot;).remove();</span><br></pre></td></tr></table></figure>

<h1 id="串行化"><a href="#串行化" class="headerlink" title="串行化"></a>串行化</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var serialized = $(&quot;#submForm&quot;).serialize()</span><br></pre></td></tr></table></figure>

<p>获取表单所有值$(“form”).serialize()</p>
<h1 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$(document).ready(function () &#123;</span><br><span class="line">    $(&quot;#myForm&quot;).submit(function () &#123;</span><br><span class="line">	$(this).find(&quot;:input&quot;).filter(function () &#123;</span><br><span class="line">        return $.trim(this.value).length &gt; 0</span><br><span class="line">    &#125;).serialize();</span><br><span class="line">    alert(&quot;JavaScript done&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>$.trim() 函数用于去除字符串两端的空白字符</p>
<h1 id="jQuery-监听元素内容变化的方法"><a href="#jQuery-监听元素内容变化的方法" class="headerlink" title="jQuery 监听元素内容变化的方法"></a>jQuery 监听元素内容变化的方法</h1><blockquote>
<p>我们可以用 onchange 事件来完成元素值发生改变触发的监听。但是 onchange 比较适用于<code>&lt;input&gt;</code>、<code>&lt;textarea&gt;</code>以及 <code>&lt;select&gt;</code> 元素,对于 div，span 等元素就不能使用了。</p>
</blockquote>
<p>当 $(“span”).html() 获取的是个空，或者获取的不是自己想要的。原因是当我们获取的时候，元素的内容还没有发生改变，这个时候就需要监听这个 span 内容了。</p>
<blockquote>
<p>下面举两个小例子</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#test-editormd-view2&quot;</span>).<span class="title function_">bind</span>(<span class="string">&quot;DOMNodeInserted&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>($(e.<span class="property">target</span>).<span class="title function_">html</span>());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#test-editormd-view2&quot;</span>).<span class="title function_">on</span>(<span class="string">&quot;DOMNodeInserted&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  $(<span class="string">&quot;#content-loading&quot;</span>).<span class="title function_">remove</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="ajax-实现文件上传"><a href="#ajax-实现文件上传" class="headerlink" title="ajax 实现文件上传"></a>ajax 实现文件上传</h1><p>我在写 jQuery 接口上传文件的时候，遇到一个特头疼的问题，那就是上传图片，刚开始那我以为一个简单的 form 表单就搞定了，没想到写了两个小时都没写出来，心情那个烦躁啊，有一种想砸电脑的冲动，最后那我就用下面的方法实现了这个功能，突然发现好简单，分享给大家！废话不多说，直接上干货，代码走起。。。。</p>
<h1 id="代码块"><a href="#代码块" class="headerlink" title="代码块"></a>代码块</h1><h2 id="html-代码段"><a href="#html-代码段" class="headerlink" title="html 代码段"></a>html 代码段</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;file&quot; name=&quot;photo&quot; id=&quot;photo&quot; value=&quot;&quot; placeholder=&quot;免冠照片&quot;&gt;</span><br><span class="line">&lt;input type=&quot;button&quot; onclick=&quot;postData();&quot; value=&quot;下一步&quot; name=&quot;&quot; style=&quot;width:100px;height:30px;&quot;&gt;</span><br></pre></td></tr></table></figure>

<h2 id="jQuery-代码段"><a href="#jQuery-代码段" class="headerlink" title="jQuery 代码段"></a>jQuery 代码段</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">postData</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">    formData.<span class="title function_">append</span>(<span class="string">&quot;photo&quot;</span>,$(<span class="string">&quot;#photo&quot;</span>)[<span class="number">0</span>].<span class="property">files</span>[<span class="number">0</span>]);</span><br><span class="line">    formData.<span class="title function_">append</span>(<span class="string">&quot;service&quot;</span>,<span class="string">&#x27;App.Passion.UploadFile&#x27;</span>);</span><br><span class="line">    formData.<span class="title function_">append</span>(<span class="string">&quot;token&quot;</span>,token);</span><br><span class="line">    $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>:<span class="string">&#x27;http://www.baidu.com/&#x27;</span>, <span class="comment">/*接口域名地址*/</span></span><br><span class="line">        <span class="attr">type</span>:<span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">        <span class="attr">data</span>: formData,</span><br><span class="line">        <span class="attr">contentType</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">processData</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">success</span>:<span class="keyword">function</span>(<span class="params">res</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>);</span><br><span class="line">            <span class="keyword">if</span>(res.<span class="property">data</span>[<span class="string">&quot;code&quot;</span>]==<span class="string">&quot;succ&quot;</span>)&#123;</span><br><span class="line">                <span class="title function_">alert</span>(<span class="string">&#x27;成功&#x27;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(res.<span class="property">data</span>[<span class="string">&quot;code&quot;</span>]==<span class="string">&quot;err&quot;</span>)&#123;</span><br><span class="line">                <span class="title function_">alert</span>(<span class="string">&#x27;失败&#x27;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  $(<span class="keyword">function</span>(<span class="params"></span>)</span><br><span class="line">  &#123;$(<span class="string">&quot;.but&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    data = <span class="keyword">new</span> <span class="title class_">FormData</span>($(<span class="string">&quot;#form1&quot;</span>)[<span class="number">0</span>]);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    <span class="comment">// $.post(&#x27;up.php&#x27;,&#123;p:2&#125;,function(data)&#123;</span></span><br><span class="line">    <span class="comment">//    alert(data);</span></span><br><span class="line">    <span class="comment">//  &#125;)</span></span><br><span class="line">    $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&quot;up.php&quot;</span>,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">      <span class="attr">data</span>: data,</span><br><span class="line">      <span class="attr">dataType</span>: <span class="string">&quot;JSON&quot;</span>,</span><br><span class="line">      <span class="attr">cache</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">processData</span>: <span class="literal">false</span>, <span class="comment">//不处理发送的数据，因为data值是FormData对象，不需要对数据做处理</span></span><br><span class="line">      <span class="attr">contentType</span>: <span class="literal">false</span>, <span class="comment">//不设置Content-type请求头</span></span><br><span class="line">    &#125;).<span class="title function_">done</span>(<span class="keyword">function</span> (<span class="params">ret</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(ret);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)&#125;</span><br><span class="line">  )</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h1 id="jquery-判断点击事件是否在目标区域"><a href="#jquery-判断点击事件是否在目标区域" class="headerlink" title="jquery 判断点击事件是否在目标区域"></a>jquery 判断点击事件是否在目标区域</h1><p>很多时候需要在鼠标点击非目标区域 div 将目标 div 隐藏的效果，这是需要判断点击事件是否在目标区域内</p>
<p>jquery 的实现方法是：(最近更新,未测)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="variable language_">document</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">        e = <span class="variable language_">window</span>.<span class="property">event</span> || e; <span class="comment">// 兼容IE7</span></span><br><span class="line">        obj = $(e.<span class="property">srcElement</span> || e.<span class="property">target</span>);</span><br><span class="line">          <span class="keyword">if</span> ($(obj).<span class="title function_">is</span>(<span class="string">&quot;#elem,#elem *&quot;</span>)) &#123;</span><br><span class="line">           <span class="comment">// alert(&#x27;内部区域&#x27;);</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="title function_">alert</span>(<span class="string">&#x27;你的点击不在目标区域&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>这样就可以进行其他效果的操作了,另外一种类似思路:jquery判断点击区域 隐藏&#x2F;显示其他区域</p>
<p>原始写法:(不兼容ff)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="variable language_">document</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123; </span><br><span class="line">    <span class="keyword">if</span> ($(event.<span class="property">srcElement</span>).<span class="title function_">is</span>(<span class="string">&quot;#elem,#elem \*&quot;</span>)) &#123;</span><br><span class="line">        <span class="comment">// alert(&#x27;内部区域&#x27;);</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;    </span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;你的点击不在目标区域&#x27;</span>);</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="jQuery选择器获取第一个子元素以及带空格的class"><a href="#jQuery选择器获取第一个子元素以及带空格的class" class="headerlink" title="jQuery选择器获取第一个子元素以及带空格的class"></a>jQuery选择器获取第一个子元素以及带空格的class</h1><p>jQuery选择器选取第一个子元素</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;p:first&quot;</span>)</span><br><span class="line"><span class="string">``</span><span class="string">``</span></span><br><span class="line"></span><br><span class="line">jQuery选择器选取<span class="variable constant_">HTML</span> 中 <span class="keyword">class</span>=<span class="string">&quot;hov_bg hov2&quot;</span> <span class="keyword">class</span>中带有空格的这类元素</span><br><span class="line"><span class="string">``</span><span class="string">`javascript</span></span><br><span class="line"><span class="string">$(&quot;.hov_bg.hov2&quot;);</span></span><br></pre></td></tr></table></figure>
<p>该选择器可以筛选出同时拥有class&#x3D;”hov_bg hov2”样式的HTML元素</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;.hov2&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>该选择器可以筛选出class&#x3D;”hov2”和class&#x3D;”hov_bg hov2”的元素</p>
<p>例子:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span>simple<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer container&quot;</span>&gt;</span>complex<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">alert</span>($(<span class="string">&quot;.container.layer&quot;</span>).<span class="title function_">html</span>());</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">````</span><br><span class="line"></span><br><span class="line">class 中带空格不是指一个 class，而是指两种 class 中的任意一种。</span><br><span class="line">下面是详解：</span><br><span class="line"></span><br><span class="line">CSS 多类选择器</span><br><span class="line">在上一节中，我们处理了 class 值中包含一个词的情况。在 HTML 中，一个 class 值中可能包含一个词列表，各个词之间用空格分隔。例如，如果希望将一个特定的元素同时标记为重要（important）和警告（warning），就可以写作：</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;important warning&quot;</span>&gt;</span> This paragraph is a very important warning. <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">这两个词的顺序无关紧要，写成 warning important 也可以。</span><br><span class="line">我们假设 class 为 important 的所有元素都是粗体，而 class 为 warning 的所有元素为斜体，class 中同时包含 important 和 warning 的所有元素还有一个银色的背景 。就可以写作：</span><br><span class="line"></span><br><span class="line">```CSS</span><br><span class="line">.important &#123;[font-weight](https://www.baidu.com/s?wd=font-weight&amp;tn=SE_PcZhidaonwhc_ngpagmjz&amp;rsv_dl=gh_pc_zhidao):bold;&#125;</span><br><span class="line">.warning &#123;[font-weight](https://www.baidu.com/s?wd=font-weight&amp;tn=SE_PcZhidaonwhc_ngpagmjz&amp;rsv_dl=gh_pc_zhidao):italic;&#125;</span><br><span class="line">.important.warning &#123;background:silver;&#125;</span><br></pre></td></tr></table></figure>

<h1 id="监听滚动事件"><a href="#监听滚动事件" class="headerlink" title="监听滚动事件"></a>监听滚动事件</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="variable language_">document</span>).<span class="title function_">scroll</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> scroH = $(<span class="variable language_">document</span>).<span class="title function_">scrollTop</span>(); <span class="comment">//滚动高度</span></span><br><span class="line">  <span class="keyword">var</span> viewH = $(<span class="variable language_">window</span>).<span class="title function_">height</span>(); <span class="comment">//可见高度</span></span><br><span class="line">  <span class="keyword">var</span> contentH = $(<span class="variable language_">document</span>).<span class="title function_">height</span>(); <span class="comment">//内容高度</span></span><br><span class="line">  <span class="keyword">if</span> (scroH &gt; <span class="number">100</span>) &#123;</span><br><span class="line">    <span class="comment">//距离顶部大于100px时</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (contentH - (scroH + viewH) &lt;= <span class="number">100</span>) &#123;</span><br><span class="line">    <span class="comment">//距离底部高度小于100px</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ((contentH = scroH + viewH)) &#123;</span><br><span class="line">    <span class="comment">//滚动条滑到底部啦</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="jquery-获取所有选中的-checkbox"><a href="#jquery-获取所有选中的-checkbox" class="headerlink" title="jquery 获取所有选中的 checkbox"></a>jquery 获取所有选中的 checkbox</h1><p>获取所有 name 为 spCodeId 的 checkbox</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> spCodesTemp = <span class="string">&quot;&quot;</span>;</span><br><span class="line">$(<span class="string">&quot;input:checkbox[name=spCodeId]:checked&quot;</span>).<span class="title function_">each</span>(<span class="keyword">function</span> (<span class="params">i</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="number">0</span> == i) &#123;</span><br><span class="line">    spCodesTemp = $(<span class="variable language_">this</span>).<span class="title function_">val</span>();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    spCodesTemp += <span class="string">&quot;,&quot;</span> + $(<span class="variable language_">this</span>).<span class="title function_">val</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">$(<span class="string">&quot;#txt_spCodes&quot;</span>).<span class="title function_">val</span>(spCodesTemp);</span><br></pre></td></tr></table></figure>

<p>以类型查找</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;input[type=&#x27;checkbox&#x27;][checked]&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>以名称查找</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;input:checkbox[name=&#x27;the checkbox name&#x27;]:checked&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>&#x2F;&#x2F;如果是在某一些标签下查找的话，为了防止查找到 table #tbTemplate 元素以外的 checkbox：checked，我们可以这样来限制：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;table#tbTemplate input:checkbox[name=&#x27;the checkbox name&#x27;]:checked&quot;</span>)</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">原生态的用法</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span><span class="title class_">JavaScript</span></span><br><span class="line">$($(<span class="string">&quot;table#tbTemplate input[type=&#x27;checkbox&#x27;]&quot;</span>),<span class="keyword">function</span>(<span class="params">i,checkbox</span>)&#123;</span><br><span class="line">     <span class="keyword">if</span>(checkbox.<span class="property">checked</span>)&#123;</span><br><span class="line">          <span class="comment">// keep the state. or log this checked......</span></span><br><span class="line">     &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>判断多选框是否有选中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!$(<span class="string">&quot;input[type=&#x27;checkbox&#x27;]&quot;</span>).<span class="title function_">is</span>(<span class="string">&#x27;:checked&#x27;</span>)) &#123; </span><br><span class="line">    $(<span class="string">&#x27;#sitetable&#x27;</span>).<span class="title function_">hide</span>(); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span></span></span><br><span class="line"><span class="tag">      <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">content</span>=<span class="string">&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;use&quot;</span> <span class="attr">data-id</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;usr&quot;</span> <span class="attr">data-id</span>=<span class="string">&quot;3&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;use&quot;</span> <span class="attr">data-id</span>=<span class="string">&quot;5&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ser&quot;</span> <span class="attr">data-id</span>=<span class="string">&quot;7&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;uer&quot;</span> <span class="attr">data-id</span>=<span class="string">&quot;9&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;选择&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/static/admin/js/core/jquery.3.2.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      $(() =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;input:button&quot;</span>).<span class="title function_">click</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          $(<span class="string">&quot;input:checkbox:checked&quot;</span>).<span class="title function_">each</span>(<span class="function">(<span class="params">e, w</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>($(w).<span class="title function_">attr</span>(<span class="string">&quot;data-id&quot;</span>));</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-11-19T01:40:18.000Z" title="2020/11/19 上午9:40:18">2020-11-19</time>发表</span><span class="level-item"><time dateTime="2022-08-30T02:12:47.247Z" title="2022/8/30 上午10:12:47">2022-08-30</time>更新</span><span class="level-item">9 分钟读完 (大约1383个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/11/19/Linux%20%E9%87%8C%E7%9A%84%202&amp;gt;&amp;amp;1%20%E7%A9%B6%E7%AB%9F%E6%98%AF%E4%BB%80%E4%B9%88/">Linux 里的 2&gt;&amp;1 究竟是什么</a></h1><div class="content"><p>我们在Linux下经常会碰到<code>nohup command&gt;/dev/null 2&gt;&amp;1 &amp;</code>这样形式的命令。首先我们把这条命令大概分解下：</p>
<ul>
<li>首先就是一个<code>nohup</code>：表示当前用户和系统的会话下的进程忽略响应HUP消息。</li>
<li>&amp;是把该命令以后台的job的形式运行。</li>
<li>command&gt;&#x2F;dev&#x2F;null较好理解，&#x2F;dev&#x2F;null表示一个空设备，就是说把 command 的执行结果重定向到空设备中，说白了就是不显示任何信息。</li>
</ul>
<blockquote>
<p>可以把&#x2F;dev&#x2F;null 可以看作”黑洞”。它等价于一个只写文件。所有写入它的内容都会永远丢失，而尝试从它那儿读取内容则什么也读不到。</p>
</blockquote>
<p>那么2&gt;&amp;1又是什么含义?</p>
<hr>
<p><strong>几个基本符号及其含义：</strong></p>
<ul>
<li>&#x2F;dev&#x2F;null 表示空设备文件；</li>
<li>0 表示stdin标准输入；</li>
<li>1 表示stdout标准输出；</li>
<li>2 表示stderr标准错误。</li>
</ul>
<hr>
<p><strong>从<code>command&gt;/dev/null</code>说起</strong></p>
<p>其实这条命令是一个缩写版，对于一个重定向命令，肯定是<code>a &gt; b</code>这种形式，那么<code>command &gt; /dev/null</code>难道是command 充当 a 的角色，<code>/dev/null</code> 充当 b 的角色。这样看起来比较合理，其实一条命令肯定是充当不了 a，肯定是 command 执行产生的输出来充当 a，其实就是标准输出 stdout。所以<code>command &gt; /dev/null</code>相当于执行了<code>command 1 &gt; /dev/null</code>。执行 command 产生了标准输出 stdout（用1表示），重定向到<code>/dev/null</code>的设备文件中。</p>
<hr>
<p><strong>说说 <code>2&gt;&amp;1</code></strong></p>
<p>通过上面<code>command &gt; /dev/null</code>等价于<code>command 1 &gt; /dev/null</code>，那么对于<code>2&gt;&amp;1</code>也就好理解了，2就是标准错误，1是标准输出，那么这条命令不就是相当于把标准错误重定向到标准输出么。</p>
<hr>
<p><strong><code>2&gt;1</code>和<code>2&gt;&amp;1</code>的写法有什么区别：</strong></p>
<ul>
<li><code>2&gt;1</code>的作用是把标准错误的输出重定向到1，但这个1不是标准输出，而是一个文件!!!,文件名就是1；</li>
<li><code>2&gt;&amp;1</code>的作用是把标准错误的输出重定向到标准输出1，&amp;指示不要把1当作普通文件，而是fd&#x3D;1即标准输出来处理。</li>
</ul>
<hr>
<p><strong><code>command&gt;a 2&gt;a</code> 与 <code>command&gt;a 2&gt;&amp;1</code>的区别</strong></p>
<p>通过上面的分析，对于<code>command&gt;a 2&gt;&amp;1</code>这条命令，等价于<code>command 1&gt;a 2&gt;&amp;1</code>可以理解为执行 command 产生的标准输入重定向到文件 a 中，标准错误也重定向到文件 a 中。那么是否就说<code>command 1&gt;a 2&gt;&amp;1</code>等价于<code>command 1&gt;a 2&gt;a</code>呢。其实不是，<code>command 1&gt;a 2&gt;&amp;1</code>与<code>command 1&gt;a 2&gt;a</code>还是有区别的，区别就在于前者只打开一次文件a，后者会打开文件两次，并导致 stdout 被 stderr 覆盖。<code>&amp;1</code>的含义就可以理解为用标准输出的引用，引用的就是重定向标准输出产生打开的 a。从IO效率上来讲，<code>command 1&gt;a 2&gt;&amp;1</code>比<code>command 1&gt;a 2&gt;a</code>的效率更高。</p>
<hr>
<p><strong>为何2&gt;&amp;1要写在后面？</strong></p>
<p>index.php task testOne &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1</p>
<p>我们可以理解为，左边是标准输出，好，现在标准输出直接输入到<code>/dev/null</code>中，而<code>2&gt;&amp;1</code>是将标准错误重定向到标准输出，所以当程序产生错误的时候，相当于错误流向左边，而左边依旧是输入到<code>/dev/null</code>中。</p>
<p>可以理解为，如果写在中间，那会把隔断标准输出指定输出的文件</p>
<p>你可以用：</p>
<ul>
<li>ls 2&gt;1测试一下，不会报没有2文件的错误，但会输出一个空的文件1；</li>
<li>ls xxx 2&gt;1测试，没有xxx这个文件的错误输出到了1中；</li>
<li>ls xxx 2&gt;&amp;1测试，不会生成1这个文件了，不过错误跑到标准输出了；</li>
<li>ls xxx &gt;out.txt 2&gt;&amp;1，实际上可换成 ls xxx 1&gt;out.txt 2&gt;&amp;1；重定向符号&gt;默认是1，错误和输出都传到out.txt了。</li>
</ul>
<hr>
<p><strong>举个栗子</strong></p>
<p>来个shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//test.sh</span><br><span class="line">#!/bin/sh</span><br><span class="line">t</span><br><span class="line">date1234</span><br></pre></td></tr></table></figure>

<p><code>chmod +x test.sh</code>为test.sh增加执行权限。这里我们弄了两条命令，其中t指令并不存在，执行会报错，会输出到stderr。date能正常执行，执行会输出当前时间，会输出到stdout。</p>
<p>执行<code>./test.sh &gt; res1.log</code>结果为：</p>
<p>我们发现stderr并没有被重定向到res1.log中，stderr被打印到了屏幕上。这也进一步证明了上面说的<code>./test.sh &gt; res1.log</code>等价于<code>./test.sh 1&gt;res1.log</code></p>
<p>执行<code>./test.sh&gt;res2.log 2&gt;&amp;1</code>结果为：</p>
<p>这次我们发现stdout和stderr都被重定向到了res2.log中了。上面我们未对stderr也就是2说明如何输出，stderr就输出到了屏 幕上，这里我们不仅对stdout进行说明，重定向到res2.log中，对标准错误也进行了说明，让其重定向到res2.log的引用即 res2.log的文件描述符中。</p>
<hr>
<p><strong>再思考一下</strong></p>
<p>为何<code>2&gt;&amp;1</code>要写在 command&gt;1 的后面，直接用2可以么。比如<code>ls 2&gt;a</code>。其实这种用法也是可以的，ls 命令列出当前的目录，用stdout（1）表示，由于这个时候没有stderr（2），这个时候执行<code>ls 2&gt;a</code>也会正常产生一个 a 的文件，但是 a 的文件中是空的，因为这时候执行ls并没有产生stderr（2）。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-11-18T14:16:19.000Z" title="2020/11/18 下午10:16:19">2020-11-18</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.663Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">5 分钟读完 (大约802个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/11/18/Apache%E4%BC%AA%E9%9D%99%E6%80%81Rewrite%E8%AF%A6%E8%A7%A3/">Apache伪静态Rewrite详解</a></h1><div class="content"><h1 id="一、Rewrite规则简介："><a href="#一、Rewrite规则简介：" class="headerlink" title="一、Rewrite规则简介："></a>一、Rewrite规则简介：</h1><blockquote>
<p>Rewirte主要的功能就是实现URL的跳转，它的正则表达式是基于 Perl语言。可基于服务器级的(httpd.conf)和目录级的 (.htaccess)两种方式。如果要想用到rewrite模块，必须先安装或加载rewrite模块。方法有两种一种是编译apache的时候就直接 安装rewrite模块，别一种是编译apache时以DSO模式安装apache,然后再利用源码和apxs来安装rewrite模块。</p>
</blockquote>
<h1 id="二、在Apache配置中启用Rewrite"><a href="#二、在Apache配置中启用Rewrite" class="headerlink" title="二、在Apache配置中启用Rewrite"></a>二、在Apache配置中启用Rewrite</h1><p>打开配置文件httpd.conf：</p>
<p>复制代码 代码如下:</p>
<p>1.启用rewrite<br># LoadModule rewrite_module modules&#x2F;mod_rewrite.so 去除前面的 #<br>2.启用.htaccess<br>在虚拟机配置项中<br>AllowOverride None    修改为： AllowOverride All</p>
<h1 id="三、Rewrite基本写法"><a href="#三、Rewrite基本写法" class="headerlink" title="三、Rewrite基本写法"></a>三、Rewrite基本写法</h1><p>服务器有配置文件不可能由我们来改，所以大多情况下要在网站的根目录下建一个.htaccess文件。</p>
<p>复制代码 代码如下:</p>
<p>RewriteEngine on    &#x2F;&#x2F;启动rewrite引擎<br>RewriteRule ^&#x2F;index([0-9]<em>).html$ &#x2F;index.php?id&#x3D;$1   &#x2F;&#x2F;“([0-9]</em>)” 代表范围 用(.<em>)代表所有，下同。<br>RewriteRule ^&#x2F;index([0-9]</em>)&#x2F;$ &#x2F;index.php?id&#x3D;$1 [R]   &#x2F;&#x2F;虚拟目录</p>
<h1 id="四、Apache-mod-rewrite规则重写的标志一览"><a href="#四、Apache-mod-rewrite规则重写的标志一览" class="headerlink" title="四、Apache mod_rewrite规则重写的标志一览"></a>四、Apache mod_rewrite规则重写的标志一览</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1) R[=code](force redirect) 强制外部重定向</span><br><span class="line">强制在替代字符串加上http://thishost[:thisport]/前缀重定向到外部的URL.如果code不指定，将用缺省的302 HTTP状态码。</span><br><span class="line">2) F(force URL to be forbidden)禁用URL,返回403HTTP状态码。</span><br><span class="line">3) G(force URL to be gone) 强制URL为GONE，返回410HTTP状态码。</span><br><span class="line">4) P(force proxy) 强制使用代理转发。</span><br><span class="line">5) L(last rule) 表明当前规则是最后一条规则，停止分析以后规则的重写。</span><br><span class="line">6) N(next round) 重新从第一条规则开始运行重写过程。</span><br><span class="line">7) C(chained with next rule) 与下一条规则关联</span><br><span class="line">如果规则匹配则正常处理，该标志无效，如果不匹配，那么下面所有关联的规则都跳过。</span><br><span class="line">8) T=MIME-type(force MIME type) 强制MIME类型</span><br><span class="line">9) NS (used only if no internal sub-request) 只用于不是内部子请求</span><br><span class="line">10) NC(no case) 不区分大小写</span><br><span class="line">11) QSA(query string append) 追加请求字符串</span><br><span class="line">12) NE(no URI escaping of output) 不在输出转义特殊字符</span><br><span class="line">例如：RewriteRule /foo/(.*) /bar?arg=P1%3d$1 [R,NE] 将能正确的将/foo/zoo转换成/bar?arg=P1=zoo</span><br><span class="line">13) PT(pass through to next handler) 传递给下一个处理</span><br><span class="line">	例如:</span><br><span class="line">	RewriteRule ^/abc(.*) /def$1 [PT] # 将会交给/def规则处理</span><br><span class="line">	Alias /def /ghi</span><br><span class="line"></span><br><span class="line">14) S=num(skip next rule(s)) 跳过num条规则</span><br><span class="line">15) E=VAR:VAL(set environment variable) 设置环境变量</span><br></pre></td></tr></table></figure>


<h1 id="五、Apache-rewrite例子"><a href="#五、Apache-rewrite例子" class="headerlink" title="五、Apache rewrite例子"></a>五、Apache rewrite例子</h1><h2 id="例子一"><a href="#例子一" class="headerlink" title="例子一:"></a>例子一:</h2><p>同时达到下面两个要求：<br>1.用<a target="_blank" rel="noopener" href="http://www.jb51.net/xxx.php">http://www.jb51.net/xxx.php</a> 来访问 <a target="_blank" rel="noopener" href="http://www.jb51.net/xxx/">http://www.jb51.net/xxx/</a><br>2.用<a target="_blank" rel="noopener" href="http://yyy.jb51.net/">http://yyy.jb51.net</a> 来访问 <a target="_blank" rel="noopener" href="http://www.jb51.net/user.php?username=yyy">http://www.jb51.net/user.php?username=yyy</a> 的功能</p>
<p>代码如下:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">RewriteEngine On</span><br><span class="line">RewriteCond %&#123;HTTP_HOST&#125; ^www.jb51.net</span><br><span class="line">RewriteCond %&#123;REQUEST_URI&#125; !^user.php$</span><br><span class="line">RewriteCond %&#123;QUERY_STRING&#125; &quot;!^page&quot;</span><br><span class="line">RewriteCond %&#123;REQUEST_URI&#125; .php$</span><br><span class="line">RewriteRule (.*).php$ http://www.jb51.net/$1/ [R]</span><br><span class="line">RewriteCond %&#123;HTTP_HOST&#125; !^www.jb51.net</span><br><span class="line">RewriteRule ^(.+) %&#123;HTTP_HOST&#125; [C]</span><br><span class="line">RewriteRule ^([^.]+).jb51.net http://www.jb51.net/user.php?username=$1</span><br><span class="line">RewriteCond %&#123;REQUEST_FILENAME&#125; !-d</span><br><span class="line">RewriteCond %&#123;REQUEST_FILENAME&#125; !-f</span><br></pre></td></tr></table></figure>
<h2 id="例子二："><a href="#例子二：" class="headerlink" title="例子二："></a>例子二：</h2><p>代码如下:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/type.php?typeid=* –&gt; /type*.html</span><br><span class="line">/type.php?typeid=*&amp;page=* –&gt; /type*page*.html</span><br><span class="line">RewriteRule ^/type([0-9]+).html$ /type.php?typeid=$1 [PT]</span><br><span class="line">RewriteRule ^/type([0-9]+)page([0-9]+).html$ /type.php?typeid=$1&amp;page=$2 [PT]</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-11-18T01:32:37.000Z" title="2020/11/18 上午9:32:37">2020-11-18</time>发表</span><span class="level-item"><time dateTime="2022-09-30T23:59:15.102Z" title="2022/10/1 上午7:59:15">2022-10-01</time>更新</span><span class="level-item">25 分钟读完 (大约3713个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/11/18/ob%E7%B3%BB%E5%88%97%E5%87%BD%E6%95%B0%E6%80%BB%E7%BB%93/">ob系列函数总结</a></h1><div class="content"><p>ob系列函数中常用函数</p>
<p>ob_start();            &#x2F;&#x2F;打开一个输出缓冲区，所有的输出信息不再直接发送到浏览器，而是保存在输出缓冲区里面。<br>ob_clean();            &#x2F;&#x2F;删除内部缓冲区的内容，不关闭缓冲区(不输出)。<br>ob_end_clean();        &#x2F;&#x2F;删除内部缓冲区的内容，关闭缓冲区(不输出)。<br>ob_get_clean();        &#x2F;&#x2F;返回内部缓冲区的内容，关闭缓冲区。相当于执行 ob_get_contents() and ob_end_clean()<br>ob_flush();            &#x2F;&#x2F;发送内部缓冲区的内容到浏览器，删除缓冲区的内容，不关闭缓冲区。<br>ob_end_flush();        &#x2F;&#x2F;发送内部缓冲区的内容到浏览器，删除缓冲区的内容，关闭缓冲区。<br>ob_get_flush();        &#x2F;&#x2F;返回内部缓冲区的内容，并关闭缓冲区，再释放缓冲区的内容。相当于ob_end_flush()并返回缓冲区内容。<br>flush();               &#x2F;&#x2F;将ob_flush释放出来的内容，以及不在PHP缓冲区中的内容，全部输出至浏览器；刷新内部缓冲区的内容，并输出。</p>
<p>ob_get_contents();     &#x2F;&#x2F;返回缓冲区的内容，不输出。<br>ob_get_length();       &#x2F;&#x2F;返回内部缓冲区的长度，如果缓冲区未被激活，该函数返回FALSE。<br>ob_get_level();        &#x2F;&#x2F;Return the nesting level of the output buffering mechanism.<br>ob_get_status();       &#x2F;&#x2F;Get status of output buffers.</p>
<p>ob_implicit_flush();   &#x2F;&#x2F;打开或关闭绝对刷新，默认为关闭，打开后ob_implicit_flush(true)，所谓绝对刷新，即当有输出语句(e.g: echo)被执行时，便把输出直接发送到浏览器，而不再需要调用flush()或等到脚本结束时才输出。</p>
<p>ob_gzhandler               &#x2F;&#x2F;ob_start回调函数，用gzip压缩缓冲区的内容。<br>ob_list_handlers           &#x2F;&#x2F;List all output handlers in use<br>output_add_rewrite_var     &#x2F;&#x2F;Add URL rewriter values<br>output_reset_rewrite_vars  &#x2F;&#x2F;Reset URL rewriter values</p>
<p>这些函数的行为受php_ini设置的影响：<br>output_buffering       &#x2F;&#x2F;该值为ON时，将在所有脚本中使用输出控制；若该值为一个数字，则代表缓冲区的最大字节限制，当缓存内容达到该上限时将会自动向浏览器输出当前的缓冲区里的内容。<br>output_handler         &#x2F;&#x2F;该选项可将脚本所有的输出，重定向到一个函数。例如，将 output_handler 设置为 mb_output_handler() 时，字符的编码将被修改为指定的编码。设置的任何处理函数，将自动的处理输出缓冲。<br>implicit_flush         &#x2F;&#x2F;作用同ob_implicit_flush，默认为Off。</p>
<p>用PHP的ob_start();<br>控制您的浏览器cache</p>
<p>Output Control 函数可以让你自由控制脚本中数据的输出。它非常地有用，特别是对于：当你想在数据已经输出后，再输出文件头的情况。输出控制函数不对使用 header() 或 setcookie(), 发送的文件头信息产生影响,只对那些类似于 echo() 和 PHP 代码的数据块有作用。<br>我们先举一个简单的例子，让大家对Output Control有一个大致的印象：<br>Example 1.</p>
<p>程序代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ob_start</span>(); <span class="comment">//打开缓冲区</span></span><br><span class="line"><span class="keyword">echo</span> \<span class="string">&quot;Hellon\&quot;; //输出</span></span><br><span class="line"><span class="string">header(&quot;</span>location:index.php<span class="string">&quot;); //把浏览器重定向到index.php</span></span><br><span class="line"><span class="string">ob_end_flush();//输出全部内容到浏览器</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>所有对header()函数有了解的人都知道，这个函数会发送一段文件头给浏览器，但是如果在使用这个函数之前已经有了任何输出（包括空输出，比如空格，回车和换行）就会提示出错。如果我们去掉第一行的ob_start()，再执行此程序，我们会发现得到了一条错误提示：”Header had all ready send by”！但是加上ob_start，就不会提示出错，原因是当打开了缓冲区，echo后面的字符不会输出到浏览器，而是保留在服务器，直到你使用 flush或者ob_end_flush才会输出，所以并不会有任何文件头输出的错误！</p>
<p>一、 相关函数简介：<br>1、Flush：刷新缓冲区的内容，输出。<br>函数格式：flush()<br>说明：这个函数经常使用，效率很高。<br>2、ob_start ：打开输出缓冲区<br>函数格式：void ob_start(void)<br>说明：当缓冲区激活时，所有来自PHP程序的非文件头信息均不会发送，而是保存在内部缓冲区。为了输出缓冲区的内容，可以使用ob_end_flush()或flush()输出缓冲区的内容。<br>3 、ob_get_contents ：返回内部缓冲区的内容。<br>使用方法：string ob_get_contents(void)<br>说明：这个函数会返回当前缓冲区中的内容，如果输出缓冲区没有激活，则返回 FALSE 。<br>4、ob_get_length：返回内部缓冲区的长度。<br>使用方法：int ob_get_length(void)<br>说明：这个函数会返回当前缓冲区中的长度；和ob_get_contents一样，如果输出缓冲区没有激活。则返回 FALSE。<br>5、ob_end_flush ：发送内部缓冲区的内容到浏览器，并且关闭输出缓冲区。<br>使用方法：void ob_end_flush(void)<br>说明：这个函数发送输出缓冲区的内容（如果有的话）。<br>6、ob_end_clean：删除内部缓冲区的内容，并且关闭内部缓冲区<br>使用方法：void ob_end_clean(void)<br>说明：这个函数不会输出内部缓冲区的内容而是把它删除！<br>7、ob_implicit_flush：打开或关闭绝对刷新<br>使用方法：void ob_implicit_flush ([int flag])<br>说明：使用过Perl的人都知道$|&#x3D;x的意义，这个字符串可以打开&#x2F;关闭缓冲区，而ob_implicit_flush函数也和那个一样，默认为关闭缓冲区，打开绝对输出后，每个脚本输出都直接发送到浏览器，不再需要调用 flush()</p>
<p>二、深入了解：</p>
<ol>
<li>关于Flush函数：<br>这个函数在PHP3中就出现了，是一个效率很高的函数，他有一个非常有用的功能就是刷新browser的cache.我们举一个运行效果非常明显的例子来说明flush.<br>Example 2.<br>程序代码<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt;= <span class="number">300</span>; <span class="variable">$i</span>++ ) <span class="keyword">print</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">    <span class="comment">// 这一句话非常关键，cache的结构使得它的内容只有达到一定的大小才能从浏览器里输出</span></span><br><span class="line">    <span class="comment">// 换言之，如果cache的内容不达到一定的大小，它是不会在程序执行完毕前输出的。经</span></span><br><span class="line">    <span class="comment">// 过测试，我发现这个大小的底限是256个字符长。这意味着cache以后接收的内容都会</span></span><br><span class="line">    <span class="comment">// 源源不断的被发送出去。</span></span><br><span class="line">    <span class="title function_ invoke__">For</span>(<span class="variable">$j</span> = <span class="number">1</span>; <span class="variable">$j</span> &lt;= <span class="number">20</span>; <span class="variable">$j</span>++) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$j</span>.<span class="string">&quot;</span></span><br><span class="line"><span class="string">    &quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">flush</span>(); <span class="comment">//这一部会使cache新增的内容被挤出去，显示到浏览器上</span></span><br><span class="line">    <span class="title function_ invoke__">sleep</span>(<span class="number">1</span>); <span class="comment">//让程序&quot;睡&quot;一秒钟，会让你把效果看得更清楚</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>注：如果在程序的首部加入ob_implicit_flush()打开绝对刷新,就可以在程序中不再使用flush(),这样做的好处是：提高效率！</p>
<ol>
<li>关于ob系列函数：<br>我想先引用我的好朋友y10k的一个例子：<br>Example 3.</li>
</ol>
<p>比如你用得到服务器和客户端的设置信息，但是这个信息会因为客户端的不同而不同，如果想要保存phpinfo()函数的输出怎么办呢？在没有缓冲区控制之前，可以说一点办法也没有，但是有了缓冲区的控制，我们可以轻松的解决：<br>程序代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ob_start</span>(); <span class="comment">//打开缓冲区</span></span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>(); <span class="comment">//使用phpinfo函数</span></span><br><span class="line"><span class="variable">$info</span>=<span class="title function_ invoke__">ob_get_contents</span>(); <span class="comment">//得到缓冲区的内容并且赋值给$info</span></span><br><span class="line"><span class="variable">$file</span>=<span class="title function_ invoke__">fopen</span>(\<span class="string">&#x27;info.txt\&#x27;,\&#x27;w\&#x27;); //打开文件info.txt</span></span><br><span class="line"><span class="string">fwrite($file,$info); //写入信息到info.txt</span></span><br><span class="line"><span class="string">fclose($file); //关闭文件info.txt</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>用以上的方法，就可以把不同用户的phpinfo信息保存下来，这在以前恐怕没有办法办到！其实上面就是将一些”过程”转化为”函数”的方法！<br>或许有人会问：”难道就这个样子吗？还有没有其他用途？”当然有了，比如笔者论坛的PHP 语法加亮显示就和这个有关（PHP默认的语法加亮显示函数会直接输出，不能保存结果，如果在每次调用都显示恐怕会很浪费CPU，笔者的论坛就把语法加亮函数显示的结果用控制缓冲区的方法保留了），大家如果感兴趣的话可以来看看</p>
<p>可能现在大家对ob_start()的功能有了一定的了解，上面的一个例子看似简单，但实际上已经掌握了使用ob_start()的要点。<br>&lt;1&gt;.使用ob_start打开browser的cache，这样可以保证cache的内容在你调用flush(),ob_end_flush()（或程序执行完毕）之前不会被输出。<br>&lt;2&gt;.现在的你应该知道你所拥有的优势：可以在任何输出内容后面使用header,setcookie以及session，这是 ob_start一个很大的特点；也可以使用ob_start的参数，在cache被写入后，然后自动运行命令，比如ob_start(\ “ob_gzhandler&quot;)；而我们最常用的做法是用ob_get_contents()得到cache中的内容，然后再进行处理……<br>&lt;3&gt;.当处理完毕后，我们可以使用各种方法输出，flush(),ob_end_flush(),以及等到程序执行完毕后的自动输出。当然，如果你用的是ob_get_contents()，那么就要你自己控制输出方式了。</p>
<p>来，让我们看看能用ob系列函数做些什么……</p>
<p>一、 静态模版技术</p>
<p>简介：所谓静态模版技术就是通过某种方式，使得用户在client端得到的是由PHP产生的html页面。如果这个html页面不会再被更新，那么当另外的用户再次浏览此页面时，程序将不会再调用PHP以及相关的数据库，对于某些信息量比较大的网站，例如sina,163,sohu。类似这种的技术带来的好处是非常巨大的。</p>
<p>我所知道的实现静态输出的有两种办法：<br>&lt;1&gt;.通过y10k修改的phplib的一个叫template.inc.php类实现。<br>&lt;2&gt;.使用ob系列函数实现。<br>对于第一种方法，因为不是这篇文章所要研究的问题，所以不再赘述。<br>我们现在来看一看第二种方法的具体实现：<br>Example 4.</p>
<p>程序代码 程序代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ob_start</span>();<span class="comment">//打开缓冲区</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">php页面的全部输出</span><br><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">ob_get_contents</span>();<span class="comment">//取得php页面输出的全部内容</span></span><br><span class="line"><span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;output00001.html&quot;</span>, <span class="string">&quot;w&quot;</span>); <span class="comment">//创建一个文件，并打开，准备写入</span></span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="variable">$content</span>); <span class="comment">//把php页面的内容全部写入output00001.html，然后……</span></span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这样，所谓的静态模版就很容易的被实现了……</p>
<p>二、 捕捉输出</p>
<p>以上的Example 4.是一种最简单的情况，你还可以在写入前对$content进行操作……<br>你可以设法捕捉一些关键字，然后去对它进行再处理，比如Example 3.所述的PHP语法高亮显示。个人认为，这个功能是此函数最大的精华所在，它可以解决各种各样的问题，但需要你有足够的想象力……</p>
<p>Example 5.</p>
<p>程序代码 程序代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run_code</span>(<span class="params"><span class="variable">$code</span></span>) </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">If</span>(<span class="variable">$code</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">ob_start</span>();</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">       <span class="variable">$contents</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line">       <span class="title function_ invoke__">ob_end_clean</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;错误！没有输出&quot;</span>;</span><br><span class="line">       <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$contents</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上这个例子的用途不是很大，不过很典型$code的本身就是一个含有变量的输出页面，而这个例子用eval把$code中的变量替换，然后对输出结果再进行输出捕捉，再一次的进行处理……</p>
<p>二、 输出缓存句柄ob_gzhandler</p>
<p>PHP4.0.4有一个新的输出缓存句柄ob_gzhandler，它与前面的类相似，但用法不同。使用ob_gzhandler时要在php.ini中加入的内容如下：   </p>
<p>output_handler &#x3D; ob_gzhandler;</p>
<p>这行代码使得PHP激活输出缓存，并压缩它发送出去的所有内容。<br>如果由于某种原因你不想在php.ini中加上这行代码，你还可以通过PHP源文件所在目录的.htaccess文件改变默认的服务器行为（不压缩），语法如下：    </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_value output_handler ob_gzhandler</span><br></pre></td></tr></table></figure>
<p>或者是从PHP代码调用，如下所示：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">ob_start</span>(<span class="string">&quot;ob_gzhandler&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>采用输出缓存句柄的方法确实非常有效，而且不会给服务器带来什么特殊的负荷。但必须注意的是，Netscape Communicator对压缩图形的支持不佳，因此除非你能够保证所有用户都使用IE浏览器，否则你应该禁止压缩JPEG和GIF图形。一般地，对于所有其他文件，这种压缩都有效，但建议你针对各种浏览器都分别进行测试，特别是当你使用了特殊的插件或者数据查看器时这一点尤其重要。<br>注意事项：<br>1、一些Web服务器的output_buffering默认是4069字符或者更大，即输出内容必须达到4069字符服务器才会flush刷新输出缓冲，为了确保flush有效，最好在ob_flush()函数前有以下语句：<br>代码如下:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;&quot;</span>, <span class="number">4096</span>);  <span class="comment">//以确保到达output_buffering值</span></span><br></pre></td></tr></table></figure>
<p>2、ob_* 系列函数是操作PHP本身的输出缓冲区，所以ob_flush只刷新PHP自身的缓冲区，而flush是刷新apache的缓冲区。所以，正确使用俩者的顺序是：先ob_flush，然后flush。ob_flush是把数据从PHP的缓冲中释放出来，flush是把缓冲内&#x2F;外的数据全部发送到浏览器。<br>3、不要误认为用了ob_start()后，脚本的echo&#x2F;print等输出就永远不会显示在浏览器上了。因为PHP脚本运行结束后，会自动刷新缓冲区并输出内容。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-11-12T03:04:38.000Z" title="2020/11/12 上午11:04:38">2020-11-12</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.663Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">2 分钟读完 (大约367个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/11/12/%E5%85%B3%E4%BA%8Elinux%E4%B8%AD%E6%97%A5%E8%AF%AD%E7%9A%84%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98/">关于linux中日语的编码问题</a></h1><div class="content"><p>对于日语的编码</p>
<p>windows ： Shift-JIS</p>
<p>Linux ： 2.4内核使用EUC编码，2.6内核中使用UTF8编码</p>
<p>检查文件编码  nkf -g filename</p>
<p>通常处理字符编码都使用iconv这个命令，但是iconv命令只能用来处理文件名，但对于文本内容的编码就无法处理了，</p>
<p>要想对文本内容的字符编码进行转换，就要用到nkf了</p>
<p>-j           : 转换为 JIS 编码(ISO-2022-JP)，默认<br>-e           : 转换为 EUC 编码<br>-s           : 转换为 Shift-JIS 编码<br>-w           : 转换为 UTF-8 编码（无BOM）<br>-Lu          : 转换为 unix 换行格式(LF)<br>-Lw          : 转换为 windows 换行格式(CRLF)<br>-Lm          : 转换为 macintosh 换行格式(CR)<br>-g(–guess)  : 自动判断编码并显示<br>–version    : 显示版本<br>–help       : 显示帮助<br>linux中转换成window     ：   nkf -sxLw    nkf -swLw<br>window转换成linux         ：   nkf -wxLu</p>
<p>在vim中输入:e ++enc&#x3D;utf8可以快速解决vim乱码问题，即使语言配置不正确，也可以快速解决乱码问题。</p>
<p>这种方式的原理是:  当vim无法识别文档的编码的时候，会使用latin-1去读取，导致文档显示上出现乱码，上述命令，就会让vim用utf-8编码的方式重新加载一遍，当然如果你的文档是用gbk编码的，可以使用: e ++&#x3D;enc&#x3D;gbk的方式来转换。</p>
<p>设置编码还可以用set encoding &#x2F; set fileencoding</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-10-29T12:38:50.000Z" title="2020/10/29 下午8:38:50">2020-10-29</time>发表</span><span class="level-item"><time dateTime="2022-09-18T01:43:48.411Z" title="2022/9/18 上午9:43:48">2022-09-18</time>更新</span><span class="level-item">几秒读完 (大约76个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/10/29/PHP%E9%99%90%E9%80%9F%E4%B8%8B%E8%BD%BD/">PHP限速下载</a></h1><div class="content"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$arr</span> = [</span><br><span class="line">    <span class="string">&quot;b798abe6e1b1318ee36b0dcb3fb9e4d3&quot;</span> =&amp;gt; [<span class="string">&quot;./img/img.jpg&quot;</span>, <span class="string">&quot;img.jpg&quot;</span>],</span><br><span class="line">    <span class="string">&quot;4cf350692a4a3bb54d13daacfe8c683b&quot;</span> =&amp;gt; [<span class="string">&quot;./img/小明.chw&quot;</span>, <span class="string">&quot;小明.chw&quot;</span>]</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:application/octet-stream&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-disposition:attachment;filename=&quot;</span> . <span class="variable">$arr</span>[<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]][<span class="number">1</span>]);</span><br><span class="line"><span class="comment">//    readfile($arr[$_GET[&quot;file&quot;]][0]);</span></span><br><span class="line"><span class="variable">$handler</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$arr</span>[<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]][<span class="number">0</span>], <span class="string">&quot;rb&quot;</span>);</span><br><span class="line"><span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$handler</span>)) &#123;</span><br><span class="line">    <span class="variable">$files</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$handler</span>, <span class="number">100</span>); <span class="comment">//限速下载</span></span><br><span class="line"><span class="comment">//        flush();</span></span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="variable">$files</span>);</span><br><span class="line">    <span class="title function_ invoke__">usleep</span>(<span class="number">20</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$handler</span>);</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-10-25T11:15:36.000Z" title="2020/10/25 下午7:15:36">2020-10-25</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.663Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">12 分钟读完 (大约1813个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/10/25/%E8%AF%91-%E5%9C%A8%E5%A4%9A%E4%B8%AA%E6%A0%87%E7%AD%BE%E9%A1%B5%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%ABsessionStorage/">译-在多个标签页之间共享sessionStorage</a></h1><div class="content"><p>昨天，就在昨天，前端一同事提了一个问题：<strong>我们的系统，用户重新开一个标签页，就要重新登录</strong>。我当时觉得这怎么可能？结果现场一测，还真是，好尴尬！</p>
<p>今天抽了点时间网上查了查，才发现原来一直以为很简单的sessionStorage，还真埋了这么一颗雷。不过国外前辈也提出了一个解决方案，不仅如此，文章还把浏览器端保存数据的场景分析的很透彻，所以斗胆翻译了一下。</p>
<h2 id="原文翻译"><a href="#原文翻译" class="headerlink" title="原文翻译"></a>原文翻译</h2><p>我实现了一种机制可以利用浏览器提供的sessionStorage或memoryStorageStorage的固有的安全性来实现用户身份认证，并且可以保证用户不需要每次新开一个标签页都重新登录。</p>
<h4 id="现有的浏览器存储机制"><a href="#现有的浏览器存储机制" class="headerlink" title="现有的浏览器存储机制"></a>现有的浏览器存储机制</h4><ul>
<li><strong>localStorage</strong>：~5MB，数据永久保存直到用户手动删除</li>
<li><strong>sessionStorage</strong>：~5MB，数据只在当前标签页有效</li>
<li><strong>cookie</strong>：~4KB，可以设置成永久有效</li>
<li><strong>session cookie</strong>：~4KB，当用户关闭浏览器时删除（并非总能立即删除）</li>
</ul>
<h4 id="安全的认证token保存"><a href="#安全的认证token保存" class="headerlink" title="安全的认证token保存"></a>安全的认证token保存</h4><p>一些重要的系统会要求当用户关闭标签页时会话立刻到期。</p>
<p>为了达到这个目的，不仅绝对不应该使用cookies来保存任何敏感信息（例如认证token）。甚至session-cookies也无法满足要求，它在标签页关闭（甚至浏览器完全关闭）后还会持续存活一定时间。</p>
<p>（任何时刻我们都不应该只使用cookies，它还有其他很多问题需要讨论，例如CSRF）</p>
<p>这些问题就使得我们在保存认证token时应使用内存或sessionStorage。sessionStorage的好处是它允许跨多个页面保存数据，并且也支持浏览器刷新操作。这样用户就可以在多个页面之间跳转或刷新页面而保持登录状态。</p>
<p>Good。我们将token保存在sessionStorage，并在每次请求服务器时将token放在请求头中来完成用户的身份认证。当用户关闭标签页，token会立即过期。</p>
<h4 id="但多标签页怎么办？"><a href="#但多标签页怎么办？" class="headerlink" title="但多标签页怎么办？"></a>但多标签页怎么办？</h4><p>即便是在单页面应用中也有一个很常见的情况，用户经常希望打开多个标签页。而此场景下将token保存在sessionStorage中将会带来很差的用户体验，每次开启一个标签页都会要求用户重新登录。没错，sessionStorage不支持跨标签页共享数据。</p>
<h4 id="利用localStorage事件来跨标签页共享sessionStorage"><a href="#利用localStorage事件来跨标签页共享sessionStorage" class="headerlink" title="利用localStorage事件来跨标签页共享sessionStorage"></a>利用localStorage事件来跨标签页共享sessionStorage</h4><p>我利用localStorage事件提出了一种解决方案。</p>
<p>当用户新开一个标签页时，我们先来询问其它已经打开的标签页是不是有需要给我们共享的sessionStorage数据。如果有，现有的标签页会通过localStorage事件来传递数据到新打开的标签页中，我们只需要复制一份到本地sessionStorage即可。</p>
<p>传递过来的sessionStorage绝对不会保存在localStorage，从localStorage事件将数据中复制并保存到sessionStorage，这个流程是在同一个调用中完成，没有中间状态。而且数据是对应事件携带的，并不在localStorage中。（译者注：作者意图解释这个方案的安全性）</p>
<p><a target="_blank" rel="noopener" href="https://blog.guya.net/security/browser_session/sessionStorage.html">在线例子</a></p>
<p>点击“Set the sessionStorage”，然后打开多个标签页，你会发现sessionStorage共享了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// 为了简单明了删除了对IE的支持[好像支持ie11]</span><br><span class="line">(function() &#123;</span><br><span class="line"></span><br><span class="line">//这段代码只在当前页面加入，需要跳转到的页面不需要</span><br><span class="line">//sessionStorage.setItem(&amp;#039;user&amp;#039;,&amp;#039;chengyao&amp;#039;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	if (!sessionStorage.length) &#123;</span><br><span class="line">		// 这个调用能触发目标事件，从而达到共享数据的目的</span><br><span class="line">		localStorage.setItem(&amp;#039;getSessionStorage&amp;#039;, Date.now());</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	// 该事件是核心</span><br><span class="line">	window.addEventListener(&amp;#039;storage&amp;#039;, function(event) &#123;</span><br><span class="line">		if (event.key === &amp;#039;getSessionStorage&amp;#039;) &#123;</span><br><span class="line">			// 已存在的标签页会收到这个事件</span><br><span class="line">			localStorage.setItem(&amp;#039;sessionStorage&amp;#039;, JSON.stringify(sessionStorage));</span><br><span class="line">			localStorage.removeItem(&amp;#039;sessionStorage&amp;#039;);</span><br><span class="line"></span><br><span class="line">		&#125; else if (event.key === &amp;#039;sessionStorage&amp;#039; &amp;amp;&amp;amp; !sessionStorage.length) &#123;</span><br><span class="line">			// 新开启的标签页会收到这个事件</span><br><span class="line">			var data = JSON.parse(event.newValue)</span><br><span class="line">			//,value;</span><br><span class="line"></span><br><span class="line">			for (key in data) &#123;</span><br><span class="line">				sessionStorage.setItem(key, data[key]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>（译者注：上面的代码是我从在线demo中截取的，原文中并无提到）</p>
<h4 id="接近完美"><a href="#接近完美" class="headerlink" title="接近完美"></a>接近完美</h4><p>我们现在拥有了一个几乎非常安全的方案来保存会话token在浏览器里，并支持良好的多标签页用户体验。现在当用户关闭标签页后能确保会话立即过期。难道不是么？</p>
<p>chrome和firefox都支持当用户进行“重新打开关闭的标签页”或“撤销关闭标签页”时恢复sessionStorage。F**k！（译者注：作者原文用的是“Damn it!”，注意到那个叹号了吗？）</p>
<p>safari在这个问题上处理是正确的，它并不会恢复sessionStorag（只测试了上述这三个浏览器）。</p>
<p>对用户而言，能够确定sessionStorag已经过期的方法是直接重新打开网站，而不是选择“重新打开关闭的标签页”。</p>
<p>除非chrome和firefox能够解决这个bug。（但我预感开发组会称其为“特性”）</p>
<p>即便存在这样的bug，使用sessionStorag依然要比session-cookies方案或其他方案要安全。如果我们希望得到一个更加完美的方案，我们就需要自己来实现一个内存的方案来代替sessionStorag。(onbeforeunload也能做到，但不是太可靠且每次刷新页面也会被清空。window.name也不错，但它太老了且也不支持跨域保护)</p>
<h4 id="跨标签页共享memoryStorage"><a href="#跨标签页共享memoryStorage" class="headerlink" title="跨标签页共享memoryStorage"></a>跨标签页共享memoryStorage</h4><p>这应该是唯一一个真正安全的实现浏览器端保存认证token的方法了，并且要保证用户打开多个标签页不需要重新登录。</p>
<p>关闭标签页，会话立即过期–这次是真真儿的。</p>
<p>这个方案的缺点是，<strong>当只有一个标签页时</strong>，浏览器刷新会导致用户重新登录。安全总是要付出点代价的，很明显这个缺点可能是致命的。</p>
<p><a target="_blank" rel="noopener" href="https://blog.guya.net/security/browser_session/memoryStorage.html">在线例子</a></p>
<p>设置一个memoryStorage，然后打开多个标签页，你会发现数据共享了。关闭所有标签页token会立即永久过期（memoryStorage其实就是一个javascript对象而已）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">(function() &#123;</span><br><span class="line"></span><br><span class="line">	window.memoryStorage = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">	function isEmpty(o) &#123;</span><br><span class="line">		for (var i in o) &#123;</span><br><span class="line">	  		return false;</span><br><span class="line">	 	&#125;</span><br><span class="line">	 	return true;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	if (isEmpty(memoryStorage)) &#123;</span><br><span class="line">		localStorage.setItem(&amp;#039;getSessionStorage&amp;#039;, Date.now());</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	window.addEventListener(&amp;#039;storage&amp;#039;, function(event) &#123;</span><br><span class="line">		if (event.key == &amp;#039;getSessionStorage&amp;#039;) &#123;</span><br><span class="line">			localStorage.setItem(&amp;#039;sessionStorage&amp;#039;, JSON.stringify(memoryStorage));</span><br><span class="line">			localStorage.removeItem(&amp;#039;sessionStorage&amp;#039;);</span><br><span class="line"></span><br><span class="line">		&#125; else if (event.key == &amp;#039;sessionStorage&amp;#039; &amp;amp;&amp;amp; isEmpty(memoryStorage)) &#123;</span><br><span class="line">			var data = JSON.parse(event.newValue),</span><br><span class="line">						value;</span><br><span class="line"></span><br><span class="line">			for (key in data) &#123;</span><br><span class="line">				memoryStorage[key] = data[key];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>原文：<a target="_blank" rel="noopener" href="https://blog.guya.net/2015/06/12/sharing-sessionstorage-between-tabs-for-secure-multi-tab-authentication/">Sharing sessionStorage between tabs for secure multi-tab authentication</a></p>
<h2 id="译者得er瑟"><a href="#译者得er瑟" class="headerlink" title="译者得er瑟"></a>译者得er瑟</h2></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-10-13T07:35:48.000Z" title="2020/10/13 下午3:35:48">2020-10-13</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.663Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">2 分钟读完 (大约274个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/10/13/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">正则表达式</a></h1><div class="content"><p>&gt; PHP官方文档：<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/book.pcre.php">https://www.php.net/manual/zh/book.pcre.php</a></p>
<p>写个可以匹配一下各种特殊字符的正则表达式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">((?=[\x21-\x7e]+)[^A-Za-z0-9])</span><br><span class="line">x21-\x7e]+)[^A-Za-z0-9])</span><br></pre></td></tr></table></figure>

<p>这个匹配所有键盘上可见的非字母和数字的符号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var patrn = /[`~!@#$%^&amp;amp;*()_\-+=&amp;lt;&amp;gt;?:&amp;quot;&#123;&#125;|,.\/;&amp;#039;\\[\]·~！@#￥%……&amp;amp;*（）——\-+=&#123;&#125;|《》？：“”【】、；‘&amp;#039;，。、]/im; </span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if (!patrn.test(str)) </span><br><span class="line">&#123;</span><br><span class="line">	// 如果包含特殊字符返回false</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line">return true;</span><br></pre></td></tr></table></figure>

<p>废话少说，代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[^\\S\\r\\n]</span><br></pre></td></tr></table></figure>
<p>\ s用于查找空白字符。</p>
<p>空白字符可以是：空格字符,制表符,回车符,换行符,垂直制表符,换页字符,\S是\s的取反。</p>
<p>解读：判断这个字符，首先 不是 非空白字符（也就是空白字符），然后不是回车符和换行符。</p>
<p>[]结构^开头，那么三个转义字符都是 非 判断。</p>
<p>PHP正则中的后向引用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(&amp;#<span class="number">039</span>;/(test)(date)/&amp;<span class="comment">#039;, &amp;#039;$&#123;1&#125;&amp;#039;, &amp;#039;testdate&amp;#039;);</span></span><br></pre></td></tr></table></figure>
<p>输出<code>testtest</code></p>
<p>其中的<code>$&#123;1&#125;</code> 也可以写作<code>\1</code>或者<code>\\1</code>,表示第一个元组。</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2020/10/06/datatables%20%E4%BD%BF%E7%94%A8/"><img class="fill" src="https://tse1-mm.cn.bing.net/th/id/R-C.4da489b4bcbd77dd481b4e624c7728ae?rik=ba8cXbjY5uvWJQ&amp;riu=http%3a%2f%2fwww.tractionsoftware.jp%2fdb%2fattachments%2fblog%2f1381%2f4%2fdatatables_logo.png&amp;ehk=Tu6BomIXqqwSvfAlDli5ntADcxnzZeUDeHb901FXORE%3d&amp;risl=&amp;pid=ImgRaw&amp;r=0" alt="datatables 使用"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-10-06T03:26:54.000Z" title="2020/10/6 上午11:26:54">2020-10-06</time>发表</span><span class="level-item"><time dateTime="2022-10-02T11:25:50.592Z" title="2022/10/2 下午7:25:50">2022-10-02</time>更新</span><span class="level-item">8 分钟读完 (大约1149个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/10/06/datatables%20%E4%BD%BF%E7%94%A8/">datatables 使用</a></h1><div class="content"><p>来源：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/showcase/p/11130463.html">https://www.cnblogs.com/showcase/p/11130463.html</a></p>
<h2 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h2><blockquote>
<p>官网：<a target="_blank" rel="noopener" href="https://datatables.net/">https://datatables.net/</a><br>中文官网：<a target="_blank" rel="noopener" href="http://datatables.club/">http://datatables.club/</a></p>
</blockquote>
<p>Datatables是一款<code>jquery</code>表格插件。它是一个高度灵活的工具，可以将任何HTML表格添加高级的交互功能。</p>
<ul>
<li>分页，即时搜索和排序</li>
<li>几乎支持任何数据源：DOM， javascript， Ajax 和 服务器处理</li>
<li>支持不同主题 DataTables, jQuery UI, Bootstrap, Foundation</li>
<li>各式各样的扩展: Editor, TableTools, FixedColumns ……</li>
<li>丰富多样的option和强大的API</li>
<li>支持国际化</li>
<li>超过2900+个单元测试</li>
<li>免费开源</li>
</ul>
<h2 id="二、使用"><a href="#二、使用" class="headerlink" title="二、使用"></a>二、使用</h2><h3 id="1、引入相关js和css文件"><a href="#1、引入相关js和css文件" class="headerlink" title="1、引入相关js和css文件"></a>1、引入相关js和css文件</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- DataTables CSS --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://cdn.datatables.net/1.10.15/css/jquery.dataTables.css&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- jQuery --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf8&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://code.jquery.com/jquery-1.10.2.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- DataTables --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf8&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://cdn.datatables.net/1.10.15/js/jquery.dataTables.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="2、添加HTML代码"><a href="#2、添加HTML代码" class="headerlink" title="2、添加HTML代码"></a>2、添加HTML代码</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">&quot;table_id_example&quot;</span> <span class="attr">class</span>=<span class="string">&quot;display&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>Column 1<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>Column 2<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>Row 1 Data 1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>Row 1 Data 2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>Row 2 Data 1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>Row 2 Data 2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3、初始化Datatables"><a href="#3、初始化Datatables" class="headerlink" title="3、初始化Datatables"></a>3、初始化Datatables</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="variable language_">document</span>).<span class="title function_">ready</span>( <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    $(<span class="string">&#x27;#table_id_example&#x27;</span>).<span class="title class_">DataTable</span>();</span><br><span class="line">&#125; );</span><br></pre></td></tr></table></figure>

<h3 id="4、效果"><a href="#4、效果" class="headerlink" title="4、效果"></a>4、效果</h3><h2 id="三、常用选项"><a href="#三、常用选项" class="headerlink" title="三、常用选项"></a>三、常用选项</h2><h3 id="order"><a href="#order" class="headerlink" title="order"></a>order</h3><blockquote>
<p>应用于表的初始顺序（排序） </p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 参数<span class="number">1</span> 列索引按顺序排列 从<span class="number">0</span>开始 </span><br><span class="line"># 参数<span class="number">2</span> 排序的规则</span><br><span class="line"><span class="string">&quot;order&quot;</span>: [[ <span class="number">1</span>, <span class="string">&quot;asc/desc&quot;</span> ],...]</span><br></pre></td></tr></table></figure>


<h3 id="stateSave"><a href="#stateSave" class="headerlink" title="stateSave"></a>stateSave</h3><blockquote>
<p>状态保存 - 页面重新加载时恢复表状态<br>启用或禁用状态保存。启用后，DataTables将存储状态信息，例如分页位置，显示长度，过滤和排序。当最终用户重新加载页面时，表的状态将被更改以匹配他们之前设置的状态。 </p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 默认值 <span class="literal">false</span></span><br><span class="line"><span class="attr">stateSave</span>: <span class="literal">true</span>/<span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h3 id="columnDefs"><a href="#columnDefs" class="headerlink" title="columnDefs"></a>columnDefs</h3><blockquote>
<p>设置列定义初始化属性<br>此参数允许您为表中的列指定特定选项，但在这种情况下，定义的列选项可应用于一个或多个列 </p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">columnDefs</span>:[</span><br><span class="line">    # 索引<span class="number">0</span>列和第<span class="number">8</span>列，不进行排序</span><br><span class="line">    &#123;<span class="attr">targets</span>:[<span class="number">0</span>,<span class="number">8</span>],<span class="attr">orderable</span>:<span class="literal">false</span>&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="lengthMenu"><a href="#lengthMenu" class="headerlink" title="lengthMenu"></a>lengthMenu</h3><blockquote>
<p>定义在每页显示记录数的select中显示的选项</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#example&#x27;</span>).<span class="title class_">DataTable</span>(&#123;</span><br><span class="line">  <span class="string">&quot;lengthMenu&quot;</span>: [ <span class="number">10</span>, <span class="number">25</span>, <span class="number">50</span>, <span class="number">75</span>, <span class="number">100</span> ]</span><br><span class="line">&#125;);</span><br><span class="line"># 或</span><br><span class="line">$(<span class="string">&#x27;#example&#x27;</span>).<span class="title class_">DataTable</span>(&#123;</span><br><span class="line">  <span class="string">&quot;lengthMenu&quot;</span>: [ [<span class="number">10</span>, <span class="number">25</span>, <span class="number">50</span>, -<span class="number">1</span>], [<span class="number">10</span>, <span class="number">25</span>, <span class="number">50</span>, <span class="string">&quot;所有&quot;</span>] ]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="paging"><a href="#paging" class="headerlink" title="paging"></a>paging</h3><blockquote>
<p>是否允许表格分页  true&#x2F;false</p>
<p>默认：true</p>
</blockquote>
<h3 id="info"><a href="#info" class="headerlink" title="info"></a>info</h3><blockquote>
<p>控制是否显示表格的信息   true&#x2F;false</p>
<p>默认：true</p>
</blockquote>
<h3 id="searching"><a href="#searching" class="headerlink" title="searching"></a>searching</h3><blockquote>
<p>是否允许Datatables开启本地搜索 true&#x2F;false</p>
<p>默认：true</p>
</blockquote>
<h3 id="ordering"><a href="#ordering" class="headerlink" title="ordering"></a>ordering</h3><blockquote>
<p>是否允许Datatables开启排序 true&#x2F;false</p>
<p>默认：true</p>
</blockquote>
<h3 id="processing"><a href="#processing" class="headerlink" title="processing"></a>processing</h3><blockquote>
<p>是否显示正在处理的状态 true&#x2F;false</p>
<p>默认：false</p>
</blockquote>
<h2 id="四、Ajax使用远程数据"><a href="#四、Ajax使用远程数据" class="headerlink" title="四、Ajax使用远程数据"></a>四、Ajax使用远程数据</h2><blockquote>
<p>有时从DOM读取数据太慢或太笨重，特别是在处理数千或数百万个数据行时。为了解决这个问题，DataTables的服务器端处理功能提供了一种方法，可以让服务器端的数据库引擎完成所有“繁重的工作” 。</p>
<p>当使用服务器端处理时，DataTables将在页面上每次绘制信息时向服务器发出Ajax请求（即，在分页，排序，搜索等时）。DataTables将向服务器发送许多变量，以允许它执行所需的处理，然后以DataTables所需的格式返回数据。 </p>
</blockquote>
<h3 id="1、客户端"><a href="#1、客户端" class="headerlink" title="1、客户端"></a>1、客户端</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#example&#x27;</span>).<span class="title class_">DataTable</span>( &#123;</span><br><span class="line">    <span class="comment">// 开启服务器模式</span></span><br><span class="line">    <span class="attr">serverSide</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// ajax发起请求</span></span><br><span class="line">    <span class="attr">ajax</span>: &#123;</span><br><span class="line">            <span class="comment">// 请求地址</span></span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;/data-source&#x27;</span>,</span><br><span class="line">            <span class="comment">// 请求方式 get/post</span></span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">            <span class="comment">// 头信信息 laravel post请求时 csrf</span></span><br><span class="line">            <span class="attr">headers</span>: &#123; <span class="string">&#x27;X-CSRF-TOKEN&#x27;</span> : <span class="string">&#x27;&#123;&#123; csrf_token() &#125;&#125;&#x27;</span> &#125;,</span><br><span class="line">            <span class="comment">// 请求的参数</span></span><br><span class="line">            <span class="attr">data</span>: &#123;</span><br><span class="line">                <span class="string">&quot;user_id&quot;</span>: <span class="number">451</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            // 两者写法效果一致  但是它用于搜索</span></span><br><span class="line"><span class="comment">            data: function ( d ) &#123;</span></span><br><span class="line"><span class="comment">                d.user_id = $(&#x27;#user_id&#x27;).val();</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// columns要对tr中的td单元格中的内容进行数据填充</span></span><br><span class="line">        <span class="comment">// 注意：如果data接收类似a或b的信息，实际服务器没有返回该信息，那么一定要同时设置defaultContent属性，否则报错</span></span><br><span class="line">        <span class="attr">columns</span>: [</span><br><span class="line">            <span class="comment">// 总的数量与表格的列的数量一致，不多也不少</span></span><br><span class="line">            <span class="comment">// 字段名称与sql查询出来的字段时要保持一致，就是服务器返回数据对应的字段名称</span></span><br><span class="line">            <span class="comment">// defaultContent 和 className 可选参数</span></span><br><span class="line">            &#123;<span class="string">&#x27;data&#x27;</span>:<span class="string">&#x27;字段名称1&#x27;</span>,<span class="string">&quot;defaultContent&quot;</span>: <span class="string">&quot;默认值&quot;</span>,<span class="string">&#x27;className&#x27;</span>:<span class="string">&#x27;类名&#x27;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&#x27;data&#x27;</span>:<span class="string">&#x27;字段名称n&#x27;</span>,<span class="string">&quot;defaultContent&quot;</span>: <span class="string">&quot;默认值&quot;</span>,<span class="string">&#x27;className&#x27;</span>:<span class="string">&#x27;类名&#x27;</span>&#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        创建tr/td时的回调函数，可以继续修改、优化tr/td的显示，里边有遍历效果，会依次扫描生成的每个tr</span></span><br><span class="line"><span class="comment">        row:创建好的tr的dom对象</span></span><br><span class="line"><span class="comment">        data:数据源，代表服务器端返回的每条记录的实体信息</span></span><br><span class="line"><span class="comment">        dataIndex:数据源的索引号码</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="attr">createdRow</span>:<span class="keyword">function</span>(<span class="params">row,data,dataIndex</span>)&#123;&#125;</span><br><span class="line">    </span><br><span class="line">&#125; );</span><br></pre></td></tr></table></figure>

<h3 id="2、服务端"><a href="#2、服务端" class="headerlink" title="2、服务端"></a>2、服务端</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">draw: 客户端调用服务器端次数标识</span></span><br><span class="line"><span class="comment">recordsTotal: 获取数据记录总条数</span></span><br><span class="line"><span class="comment">recordsFiltered: 数据过滤后的总数量</span></span><br><span class="line"><span class="comment">data: 获得的具体数据</span></span><br><span class="line"><span class="comment">注意：recordsTotal和recordsFiltered都设置为记录的总条数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="variable">$result</span> = [</span><br><span class="line">   <span class="string">&#x27;draw&#x27;</span> 		 	 =&gt; <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;draw&#x27;</span>),</span><br><span class="line">   <span class="string">&#x27;recordsTotal&#x27;</span> 	 =&gt; <span class="variable">$count</span>,</span><br><span class="line">   <span class="string">&#x27;recordsFiltered&#x27;</span> =&gt; <span class="variable">$count</span>,</span><br><span class="line">   <span class="string">&#x27;data&#x27;</span>			=&gt; <span class="variable">$data</span></span><br><span class="line">];</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$result</span>);</span><br></pre></td></tr></table></figure>

<h3 id="3、搜索"><a href="#3、搜索" class="headerlink" title="3、搜索"></a>3、搜索</h3><blockquote>
<p>datatable对象.api().ajax.reload()</p>
<p>重新加载数据 </p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> table = $(<span class="string">&#x27;#example&#x27;</span>).<span class="title function_ invoke__">DataTable</span>( &#123;</span><br><span class="line">    <span class="attr">ajax</span>: <span class="string">&quot;data.json&quot;</span></span><br><span class="line">&#125; );</span><br><span class="line"> </span><br><span class="line">$(<span class="string">&#x27;#search&#x27;</span>).<span class="title function_ invoke__">on</span>(<span class="string">&#x27;click&#x27;</span>,function()&#123;</span><br><span class="line">    table.ajax.<span class="title function_ invoke__">reload</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-09-28T12:31:11.000Z" title="2020/9/28 下午8:31:11">2020-09-28</time>发表</span><span class="level-item"><time dateTime="2022-08-28T02:23:10.663Z" title="2022/8/28 上午10:23:10">2022-08-28</time>更新</span><span class="level-item">18 分钟读完 (大约2640个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/09/28/postgresql/">postgresql</a></h1><div class="content"><p>sudo -i -u postgres 登录<br>\l列出所有数据库<br>\c 数据库名 选择数据库<br>\d 列出数据表<br>\d 表名 列出数据表的结构<br>create database chengyao; 创建数据库<br>drop database chengyao;删除数据库<br>psql -h localhost -p 5432 -U cheng postgres登录<br>select pg_roles.rolname from pg_roles; 查看角色<br>grant role_name to username; 赋予角色<br>修改一个字段为非null ： alter table users alter username set not null;</p>
<p>\x切换到竖排显示<br>select * from ps_proc;查询存储过程</p>
<h2 id="一、建立数据库连接"><a href="#一、建立数据库连接" class="headerlink" title="一、建立数据库连接"></a>一、建立数据库连接</h2><p>接入PostgreSQL数据库: psql -h IP地址 -p 端口 -U 数据库名</p>
<p>之后会要求输入数据库密码</p>
<p>二、访问数据库</p>
<p>1、列举数据库：\l<br>2、选择数据库：\c 数据库名<br>3、查看该某个库中的所有表：\dt<br>4、切换数据库：\c interface<br>5、查看某个库中的某个表结构：\d 表名<br>6、查看某个库中某个表的记录：select * from apps limit 1;<br>7、显示字符集：\encoding<br>8、退出psgl：\q</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>列出当前数据库所有表<br>\dt</p>
<p>列出表名<br>SELECT tablename FROM pg_tables;<br>WHERE tablename NOT LIKE ‘pg%’<br>AND tablename NOT LIKE ‘sql_%’<br>ORDER BY tablename;</p>
<p>列出数据库名<br>\l<br>或<br>SELECT datname FROM pg_database;</p>
<p>切换数据库<br>\c 数据库名</p>
<p>1、通过命令行查询<br>\d 数据库 —— 得到所有表的名字<br>\d 表名 —— 得到表结构<br>2、通过SQL语句查询<br>&quot;select * from pg_tables&quot; —— 得到当前db中所有表的信息（这里pg_tables是系统视图）<br>&quot;select tablename from pg_tables where schemaname&#x3D;’public’&quot; —— 得到所有用户自定义表的名字（这里&quot;tablename&quot;字段是表的名字，&quot;schemaname&quot;是schema的名字。用户自定义的表，如果未经特殊处理，默认都是放在名为public的schema下）</p>
<p> View Code</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>postgresql数据管理系统使用命令方式有两种:</p>
<ol>
<li>内部命令,以反斜线开始 \ ,如: \l 显示所有数据库</li>
<li>标准SQL命令,以分号 ; 或 \g 结束,可以使用多行</li>
</ol>
<p>数据库的关键操作:</p>
<ol>
<li>启动服务  2. 登录  3. 建立数据库  4. 建立表  5. 插入记录到表中 </li>
<li>更新&#x2F;删除&#x2F;查询&#x2F;修改操作           7. 退出    8. 停止服务</li>
</ol>
<p>在windows7中安装的postgresql默认使用GBK字符集,经常不能使用显示中文的数据表,解决办法:<br>注意:在windows 7下的postgresql中写操作时要使用GBK,读操作时要用UTF8;</p>
<p>设置字符集为 utf-8 就可以了.<br>postgres&#x3D;# \encoding utf-8       &#x2F;&#x2F; 设置客户端的字元集<br>postgres&#x3D;# \encoding                  &#x2F;&#x2F; 显示客户端的字元集<br>postgres&#x3D;# show client_encoding;      &#x2F;&#x2F; 显示客户端的字元集<br>postgres&#x3D;# show server_encoding;      &#x2F;&#x2F; 显示服务器的字元集</p>
<p>启动服务:<br>net start postgresql-9.5<br>停止服务:<br>net stop postgresql-9.5</p>
<p>获取命令帮助:<br>c:&amp;gt; psql –help</p>
<p>登录( 注意: postgres 是默认用户即管理员 ):<br>路径 psql -h 服务器 -U 用户名  -d 数据库 -p 端口地址  &#x2F;&#x2F; -U 是大写<br>C:&amp;gt; psql -h localhost -U postgres -p 5432            &#x2F;&#x2F; 默认打开postgres数据库<br>C:&amp;gt; psql -h 127.0.0.1 -U postgres -d fengdos -p 5432 &#x2F;&#x2F; 打开fengdos数据库<br>C:&amp;gt; psql -U postgres                                 &#x2F;&#x2F; 快速登录(全部使用默认设置)<br>&#x2F;&#x2F; 使用某些有密码的用户的情况下, 会提示输入密码.<br>用户 postgres 的口令: ILoveYou         &#x2F;&#x2F; 输入时不会显示任何字符<br>&#x2F;&#x2F; 成功后显示:<br>psql (9.5.3)<br>输入 &quot;help&quot; 来获取帮助信息.<br>&#x2F;&#x2F; 进入postgresql数据库系统提示符状态, ******&#x3D;# 中&#x3D;#前面为当前使用的数据库<br>postgres&#x3D;# help          &#x2F;&#x2F; 获取系统帮助,显示如下:</p>
<hr>
<p>您正在使用psql, 这是一种用于访问PostgreSQL的命令行界面<br>键入：\copyright 显示发行条款<br>      \h 显示 SQL 命令的说明<br>      ? 显示 pgsql 命令的说明 (pgsql内部命令)<br>      \g 或者以分号(;)结尾以执行查询<br>      \q 退出注: 数据库名称区分大小写的。</p>
<hr>
<p>postgres&#x3D;# \help         &#x2F;&#x2F; 获取SQL命令的帮助,同 \h<br>postgres&#x3D;# \quit         &#x2F;&#x2F; 退出,同 \q<br>postgres&#x3D;# \password dlf &#x2F;&#x2F; 重新设置用户dlf的密码,然后需要 \q退出后才生效<br>c:&amp;gt;psql exampledb &lt; user.sql  &#x2F;&#x2F; 将user.sql文件导入到exampled数据库中<br>postgres&#x3D;# \h select   &#x2F;&#x2F; 精细显示SQL命令中的select命令的使用方法<br>postgres&#x3D;# \l          &#x2F;&#x2F; 显示所有数据库<br>postgres&#x3D;# \dt         &#x2F;&#x2F; 显示当前数据库中的所有表<br>postgres&#x3D;# \d [table_name]  &#x2F;&#x2F; 显示当前数据库的指定表的表结构<br>postgres&#x3D;# \c [database_name]  &#x2F;&#x2F; 切换到指定数据库,相当于use<br>postgres&#x3D;# \du                 &#x2F;&#x2F; 显示所有用户<br>postgres&#x3D;# \conninfo           &#x2F;&#x2F; 显示当前数据库和连接信息<br>postgres&#x3D;# \e   &#x2F;&#x2F; 进入记事本sql脚本编辑状态(输入批命令后关闭将自动在命令行中执行)<br>postgres&#x3D;# \di  &#x2F;&#x2F; 查看索引(要建立关联)<br>postgres&#x3D;# \prompt [文本] 名称    &#x2F;&#x2F; 提示用户设定内部变数<br>postgres&#x3D;# \encoding [字元编码名称]  &#x2F;&#x2F; 显示或设定用户端字元编码<br>*可以将存储过程写在文本文件中aaa.sql,然后在psql状态下:<br>postgres&#x3D;# \i aaa.sql    &#x2F;&#x2F; 将aaa.sql导入(到当前数据库)<br>postgres&#x3D;# \df           &#x2F;&#x2F; 查看所有存储过程（函数）<br>postgres&#x3D;# \df+ name     &#x2F;&#x2F; 查看某一存储过程<br>postgres&#x3D;# select version();            &#x2F;&#x2F; 获取版本信息<br>postgres&#x3D;# select usename from pg_user; &#x2F;&#x2F; 获取系统用户信息<br>postgres&#x3D;# drop User 用户名             &#x2F;&#x2F; 删除用户</p>
<p>其它SQL命令通用如(标准化SQL语句):<br>*创建数据库：<br>create database [数据库名];</p>
<p>*删除数据库：<br>drop database [数据库名]; </p>
<p>*创建表：<br>create table ([字段名1] [类型1] ;,[字段名2] [类型2],……&lt;,primary key (字段名m,字段名n,…)&gt;;);</p>
<p>*在表中插入数据：<br>insert into 表名 ([字段名m],[字段名n],……) values ([列m的值],[列n的值],……);</p>
<p>*显示表内容:<br>select * from student;</p>
<p>*重命名一个表：<br>alter table [表名A] rename to [表名B];</p>
<p>*删除一个表：<br>drop table [表名]; </p>
<p>*在已有的表里添加字段：<br>alter table [表名] add column [字段名] [类型];</p>
<p>*删除表中的字段：<br>alter table [表名] drop column [字段名];</p>
<p>*重命名一个字段：<br>alter table [表名] rename column [字段名A] to [字段名B];</p>
<p>*给一个字段设置缺省值：<br>alter table [表名] alter column [字段名] set default [新的默认值];</p>
<p>*去除缺省值：<br>alter table [表名] alter column [字段名] drop default;</p>
<p>*修改表中的某行某列的数据：<br>update [表名] set [目标字段名]&#x3D;[目标值] where [该行特征];</p>
<p>*删除表中某行数据：<br>delete from [表名] where [该行特征];<br>delete from [表名];    &#x2F;&#x2F; 删空整个表</p>
<p>*可以使用pg_dump和pg_dumpall来完成。比如备份sales数据库：<br>pg_dump drupal&gt;&#x2F;opt&#x2F;Postgresql&#x2F;backup&#x2F;1.bak</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>1.列出所有表名的查询语句<br>SELECT tablename FROM pg_tables<br>WHERE tablename NOT LIKE ‘pg%’<br>AND tablename NOT LIKE ‘sql_%’<br>ORDER BY tablename;</p>
<p>2.列出表中所有的数据</p>
<p>SELECT * FROM someTable;</p>
<p>3.执行外部脚本<br>#&#x2F;opt&#x2F;PostgreSQL&#x2F;8. 3&#x2F;bin&#x2F;psql - Upostgres ;登陆到数据库的控制台界面<br>postgres&#x3D; # \i &#x2F;root&#x2F;db. sql<br>     \i 命令用于执行一个外部的sql脚本文件。</p>
<p>4.导出数据库为外部的脚本<br>#&#x2F;opt&#x2F;PostgreSQL&#x2F;8. 3&#x2F;bin&#x2F; pg_dump - Upostgres - C - fdb. sql database</p>
<p>-C create    -f 是导出后的文件名</p>
<p>5.postgresql 插入16进制数<br>INSERT INTO tableAAA VALUES( x’0001f’ : : integer, ‘鉴权’ , ‘Authority’ )</p>
<p>6.使用 TG_RELNAME 报错ERROR:  syntax error at or near &quot;$1&quot; at character</p>
<p>[引]<a target="_blank" rel="noopener" href="http://www.dbmonster.com/Uwe/Forum.aspx/postgresql/2051/TG-RELNAME-problem">http://www.dbmonster.com/Uwe/Forum.aspx/postgresql/2051/TG-RELNAME-problem</a></p>
<p>Perhaps you will get some idea if you read the document:<br>37. 6. 4. Executing Dynamic Commands</p>
<p>改：执行动态语句</p>
<p> EXECUTE ‘INSERT INTO TG_RELNAME VALUES (NEW.start_time , NEW.id , NEW.end_time)’;</p>
<ol start="7">
<li>psql 常用命令<br>a. \c tesdb1 - - 将当前连接的testdb数据库改变成 testdb1 。<br>b . \q - - 断开与Postgres服务器的连接<br>c . \l 列出所有数据库的名字<br> \l+ 列出所有数据库的名字以及字符集编码<br>d. \d [ 名字] 描述表, 索引, 序列, 或者视图<br>          列出表&#x2F;索引&#x2F;序列&#x2F;视图&#x2F;系统表<br>\d{t| i| s| v| S} [ 模式] ( 加 &quot;+&quot; 获取更多信息)<br>          - - 列出表&#x2F;索引&#x2F;序列&#x2F;视图&#x2F;系统表<br>\d tablename - - 查看表的结构<br>\dt - - 列出数据库中所有表</li>
</ol>
<p>8.在PostgreSQL中如何删除重复记录</p>
<p>【转】http: &#x2F; &#x2F; hi. baidu. com&#x2F;cicon&#x2F;blog&#x2F;item&#x2F;e14f217f4eeee20429388a0c. html</p>
<p>在PostgreSQL中删除重复记录其实很简单，不论有多少行重复，只要在要删除重复记录的表中table加一列rownum字段( id为table表中的主键) ，类型设置为serial类型即可，然后执行sql<br>delete from deltest where rownum not in(<br>select max(rownum) from deltest<br>);<br>最后删除列rownum即可</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>正文：</p>
<p>连接数据库操作：</p>
<p>psql是postgresql数据库提供的连接数据库shell命令，格式 psql 【option】 dbname</p>
<p>在终端输入psql 会使用默认的方式连接本地数据库，使用的用户名是登陆linux系统使用的用户名，</p>
<p>psql -U username -W pass 以及psql -U username -W pass databasenaem都可以实现连接数据库的功能，第一种方式是使用用户名username密码pass连接默认数据库（具体链接那个数据库还没搞清 楚），第二种方式使用用户名username密码pass连接username数据库。如果登录成功之后将显示类似信息</p>
<p>Welcome to psql 8.0.6, the PostgreSQL interactive terminal.</p>
<p>Type:  \copyright for distribution terms<br>       \h for help with SQL commands<br>       ? for help with psql commands<br>       \g or terminate with semicolon to execute query<br>       \q to quit</p>
<p>连接成功之后所有的命令都是使用”\“+ 字符或者word完成相应的功能。现将常用的几个列车</p>
<p>\l      列出所有数据库</p>
<p>\dt   列出连接数据库中所有表</p>
<p>\di   列出连接数据库中所有index</p>
<p>\dv  列出连接数据库中所有view</p>
<p>\h    sql命令帮助</p>
<p>?    \ 所有命令帮助</p>
<p>\q   退出连接</p>
<p>\d tablename  列出指定tablename的表结构</p>
<p>可以尝试执行下面两句sql</p>
<p>SELECT current_date</p>
<p>SELECT version()</p>
<p>是不是nothing happened，这是因为postgresql数据库要求必须使用；结尾否则不予执行，加上；之后就能看到结果了。</p>
<p>如果我们想创建数据库怎么办呢？</p>
<p>我们知道createdb和dropdb可以创建和删除数据库，但是如果我们这个时候执行出现什么问题呢？可以试一试，提示是个错误。</p>
<p>为什么呢？</p>
<p>createdb和dropdb是shell脚本，所以现在又两种方式执行</p>
<p>（1）.退出连接进入终端，输入createdb test —U user -W pass 稍等提示创建数据库成功</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dropdb test —U user -W pass    提示drop成功</span><br></pre></td></tr></table></figure>


<p>（2）.在未退出连接中使用 ! createdb test —U user -W pass 稍等提示创建数据库成功</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\! dropdb test —U user -W pass  提示drop成功</span><br></pre></td></tr></table></figure></div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/14/">上一页</a></div><div class="pagination-next"><a href="/page/16/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/14/">14</a></li><li><a class="pagination-link is-current" href="/page/15/">15</a></li><li><a class="pagination-link" href="/page/16/">16</a></li><li><a class="pagination-link" href="/page/17/">17</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/images/avatar.jpg" alt="程"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">程</p><p class="is-size-6 is-block">未至精疲力尽，不要怨天尤人。昨日因，今日果。今日为，明日果！</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Earth</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">168</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/tab-engineer" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/tab-engineer"><i class="fab fa-github"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://github.com/marxphp" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">maxphp</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><!--!--><!--!--><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-01T06:56:20.000Z">2022-10-01</time></p><p class="title"><a href="/2022/10/01/tcpdump%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/">tcpdump详细教程</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-09-18T05:06:34.000Z">2022-09-18</time></p><p class="title"><a href="/2022/09/18/Typescript%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">Typescript学习笔记</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-09-04T13:30:39.000Z">2022-09-04</time></p><p class="title"><a href="/2022/09/04/Go%E5%90%84%E6%97%B6%E9%97%B4%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E8%A7%A3%E6%9E%90/">Go各时间字符串的解析</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-08-21T02:56:27.000Z">2022-08-21</time></p><p class="title"><a href="/2022/08/21/%E7%89%88%E6%9C%AC%E5%8F%B7%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83/">版本号命名规范</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-08-19T12:54:39.000Z">2022-08-19</time></p><p class="title"><a href="/2022/08/19/Markdown%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/">Markdown基本语法</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/avatar.jpg" alt="笔记" height="28"></a><p class="is-size-7"><span>&copy; 2022 CY</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>